!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).nlp=e()}(this,(function(){"use strict";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split("");var e=function(e){let r=(e=e||"_")+"-";for(let e=0;e<7;e++)r+=t[Math.floor(Math.random()*t.length)];return r};let r={"!":"¡","?":"¿Ɂ",'"':'“”"❝❞',"'":"‘‛❛❜","-":"—–",a:"ªÀÁÂÃÄÅàáâãäåĀāĂăĄąǍǎǞǟǠǡǺǻȀȁȂȃȦȧȺΆΑΔΛάαλАадѦѧӐӑӒӓƛɅæ",b:"ßþƀƁƂƃƄƅɃΒβϐϦБВЪЬвъьѢѣҌҍ",c:"¢©ÇçĆćĈĉĊċČčƆƇƈȻȼͻͼͽϲϹϽϾСсєҀҁҪҫ",d:"ÐĎďĐđƉƊȡƋƌǷ",e:"ÈÉÊËèéêëĒēĔĕĖėĘęĚěƎƏƐǝȄȅȆȇȨȩɆɇΈΕΞΣέεξϱϵ϶ЀЁЕЭеѐёҼҽҾҿӖӗӘәӚӛӬӭ",f:"ƑƒϜϝӺӻҒғſ",g:"ĜĝĞğĠġĢģƓǤǥǦǧǴǵ",h:"ĤĥĦħƕǶȞȟΉΗЂЊЋНнђћҢңҤҥҺһӉӊ",I:"ÌÍÎÏ",i:"ìíîïĨĩĪīĬĭĮįİıƖƗȈȉȊȋΊΐΪίιϊІЇії",j:"ĴĵǰȷɈɉϳЈј",k:"ĶķĸƘƙǨǩΚκЌЖКжкќҚқҜҝҞҟҠҡ",l:"ĹĺĻļĽľĿŀŁłƚƪǀǏǐȴȽΙӀӏ",m:"ΜϺϻМмӍӎ",n:"ÑñŃńŅņŇňŉŊŋƝƞǸǹȠȵΝΠήηϞЍИЙЛПийлпѝҊҋӅӆӢӣӤӥπ",o:"ÒÓÔÕÖØðòóôõöøŌōŎŏŐőƟƠơǑǒǪǫǬǭǾǿȌȍȎȏȪȫȬȭȮȯȰȱΌΘΟθοσόϕϘϙϬϭϴОФоѲѳӦӧӨөӪӫ",p:"ƤƿΡρϷϸϼРрҎҏÞ",q:"Ɋɋ",r:"ŔŕŖŗŘřƦȐȑȒȓɌɍЃГЯгяѓҐґ",s:"ŚśŜŝŞşŠšƧƨȘșȿЅѕ",t:"ŢţŤťŦŧƫƬƭƮȚțȶȾΓΤτϮТт",u:"µÙÚÛÜùúûüŨũŪūŬŭŮůŰűŲųƯưƱƲǓǔǕǖǗǘǙǚǛǜȔȕȖȗɄΰμυϋύ",v:"νѴѵѶѷ",w:"ŴŵƜωώϖϢϣШЩшщѡѿ",x:"×ΧχϗϰХхҲҳӼӽӾӿ",y:"ÝýÿŶŷŸƳƴȲȳɎɏΎΥΫγψϒϓϔЎУучўѰѱҮүҰұӮӯӰӱӲӳ",z:"ŹźŻżŽžƩƵƶȤȥɀΖζ"},n={};Object.keys(r).forEach((function(t){r[t].split("").forEach((function(e){n[e]=t}))}));var i=t=>{let e=t.split("");return e.forEach((t,r)=>{n[t]&&(e[r]=n[t])}),e.join("")};const s=/([A-Z]\.)+[A-Z]?,?$/,o=/^[A-Z]\.,?$/,a=/[A-Z]{2,}('s|,)?$/,l=/([a-z]\.)+[a-z]\.?$/;var u=function(t){return!0===s.test(t)||(!0===l.test(t)||(!0===o.test(t)||!0===a.test(t)))};const h=/[a-z\u00C0-\u00FF] ?\/ ?[a-z\u00C0-\u00FF]/;var c=function(t){let e=t=(t=(t=t||"").toLowerCase()).trim();return t=i(t),!0===h.test(t)&&(t=t.replace(/\/.*/,"")),t=(t=(t=(t=(t=(t=(t=t.replace(/^[#@]/,"")).replace(/[,;.!?]+$/,"")).replace(/[\u0027\u0060\u00B4\u2018\u2019\u201A\u201B\u2032\u2035\u2039\u203A]+/g,"'")).replace(/[\u0022\u00AB\u00BB\u201C\u201D\u201E\u201F\u2033\u2034\u2036\u2037\u2E42\u301D\u301E\u301F\uFF02]+/g,'"')).replace(/\u2026/g,"...")).replace(/\u2013/g,"-")).replace(/([aeiou][ktrp])in$/,"$1ing"),!0===/^(re|un)-?[^aeiou]./.test(t)&&(t=t.replace("-","")),u(t)&&(t=t.replace(/\./g,"")),!1===/^[:;]/.test(t)&&(t=(t=(t=t.replace(/\.{3,}$/g,"")).replace(/[",\.!:;\?\)]+$/g,"")).replace(/^['"\(]+/g,"")),""===(t=(t=t.replace(/[\u200B-\u200D\uFEFF]/g,"")).trim())&&(t=e),t=t.replace(/([0-9]),([0-9])/g,"$1$2")};var f=function(t){return t=(t=t.replace(/['’]s$/,"")).replace(/s['’]$/,"s")};const p=/^[ \n\t\.\[\](){}⟨⟩:,،、‒–—―…!‹›«»‐\-?‘’;\/⁄·&*•^†‡°¡¿※№÷×ºª%‰+−=‱¶′″‴§~\|‖¦©℗®℠™¤₳฿\u0022\uFF02\u0027\u201C\u201F\u201B\u201E\u2E42\u201A\u2035\u2036\u2037\u301D\u0060\u301F]+/,d=/[ \n\t\.'\[\](){}⟨⟩:,،、‒–—―…!‹›«»‐\-?‘’;\/⁄·&*@•^†‡°¡¿※#№÷×ºª‰+−=‱¶′″‴§~\|‖¦©℗®℠™¤₳฿\u0022\uFF02\u201D\u00B4\u301E]+$/,m=/\//,g=/['’]/,v=/^[a-z]\.([a-z]\.)+/i,b=/^[-+\.][0-9]/,y=/^'[0-9]{2}/;var A=t=>{let e=t,r="",n="";""===(t=(t=t.replace(p,e=>(r=e,"-"!==r&&"+"!==r&&"."!==r||!b.test(t)?"'"===r&&y.test(t)?(r="",e):"":(r="",e)))).replace(d,i=>(n=i,g.test(i)&&/[sn]['’]$/.test(e)&&!1===g.test(r)?(n=n.replace(g,""),"'"):!0===v.test(t)?(n=n.replace(/\./,""),"."):"")))&&(e=e.replace(/ *$/,t=>(n=t||"","")),t=e,r="",n=n);let i=c(t);const s={text:t,clean:i,reduced:f(i),pre:r,post:n};return m.test(t)&&t.split(m).forEach(t=>{s.alias=s.alias||{},s.alias[t.trim()]=!0}),s};function w(t){var e={exports:{}};return t(e,e.exports),e.exports}var x=w((function(t,e){const r=/^[A-Z][a-z'\u00C0-\u00FF]/,n=/^[A-Z]+s?$/;e.toUpperCase=function(){return this.text=this.text.toUpperCase(),this},e.toLowerCase=function(){return this.text=this.text.toLowerCase(),this},e.toTitleCase=function(){return this.text=this.text.replace(/^ *[a-z\u00C0-\u00FF]/,t=>t.toUpperCase()),this},e.isUpperCase=function(){return n.test(this.text)},e.isTitleCase=function(){return r.test(this.text)},e.titleCase=e.isTitleCase})),P=w((function(t,e){const r=/(\u0022|\uFF02|\u0027|\u201C|\u2018|\u201F|\u201B|\u201E|\u2E42|\u201A|\u00AB|\u2039|\u2035|\u2036|\u2037|\u301D|\u0060|\u301F)/,n=/(\u0022|\uFF02|\u0027|\u201D|\u2019|\u201D|\u2019|\u201D|\u201D|\u2019|\u00BB|\u203A|\u2032|\u2033|\u2034|\u301E|\u00B4|\u301E)/;e.hasPost=function(t){return-1!==this.post.indexOf(t)},e.hasPre=function(t){return-1!==this.pre.indexOf(t)},e.hasQuote=function(){return r.test(this.pre)||n.test(this.post)},e.hasQuotation=e.hasQuote,e.hasComma=function(){return this.hasPost(",")},e.hasPeriod=function(){return!0===this.hasPost(".")&&!1===this.hasPost("...")},e.hasExclamation=function(){return this.hasPost("!")},e.hasQuestionMark=function(){return this.hasPost("?")||this.hasPost("¿")},e.hasEllipses=function(){return this.hasPost("..")||this.hasPost("…")||this.hasPre("..")||this.hasPre("…")},e.hasSemicolon=function(){return this.hasPost(";")},e.hasSlash=function(){return/\//.test(this.text)},e.hasHyphen=function(){const t=/^(-|–|—)$/;return t.test(this.post)||t.test(this.pre)},e.hasDash=function(){const t=/ (-|–|—) /;return t.test(this.post)||t.test(this.pre)},e.hasContraction=function(){return Boolean(this.implicit)},e.addPunctuation=function(t){return","!==t&&";"!==t||(this.post=this.post.replace(t,"")),this.post=t+this.post,this}}));var j=function(t,e,r=3){if(t===e)return 1;if(t.length<r||e.length<r)return 0;const n=function(t,e){let r=t.length,n=e.length;if(0===r)return n;if(0===n)return r;let i=(n>r?n:r)+1;if(Math.abs(r-n)>(i||100))return i||100;let s,o,a,l,u,h,c=[];for(let t=0;t<i;t++)c[t]=[t],c[t].length=i;for(let t=0;t<i;t++)c[0][t]=t;for(let i=1;i<=r;++i)for(o=t[i-1],s=1;s<=n;++s){if(i===s&&c[i][s]>4)return r;a=e[s-1],l=o===a?0:1,u=c[i-1][s]+1,(h=c[i][s-1]+1)<u&&(u=h),(h=c[i-1][s-1]+l)<u&&(u=h);let n=i>1&&s>1&&o===e[s-2]&&t[i-2]===a&&(h=c[i-2][s-2]+l)<u;c[i][s]=n?h:u}return c[r][n]}(t,e);let i=Math.max(t.length,e.length);return 1-(0===i?0:n/i)};let E=function(){};E=function(t,e,r,n){let i=function(t,e,r,n){if(e.id===t.id)return!0;if(!0===e.anything)return!0;if(!0===e.start&&0!==r)return!1;if(!0===e.end&&r!==n-1)return!1;if(void 0!==e.word){if(null!==t.implicit&&t.implicit===e.word)return!0;if(void 0!==t.alias&&t.alias.hasOwnProperty(e.word))return!0;if(!0===e.soft&&e.word===t.root)return!0;if(void 0!==e.fuzzy){let r=j(e.word,t.reduced);if(r>e.fuzzy)return!0;if(!0===e.soft&&(r=j(e.word,t.root),r>e.fuzzy))return!0}return e.word===t.clean||e.word===t.text||e.word===t.reduced}return void 0!==e.tag?!0===t.tags[e.tag]:void 0!==e.method?"function"==typeof t[e.method]&&!0===t[e.method]():void 0!==e.regex?e.regex.test(t.clean):void 0!==e.fastOr?!(!t.implicit||!0!==e.fastOr.hasOwnProperty(t.implicit))||e.fastOr.hasOwnProperty(t.reduced)||e.fastOr.hasOwnProperty(t.text):void 0!==e.choices&&("and"===e.operator?e.choices.every(e=>E(t,e,r,n)):e.choices.some(e=>E(t,e,r,n)))}(t,e,r,n);return!0===e.negative?!i:i};var O=E;const C={};var F={doesMatch:function(t,e,r){return O(this,t,e,r)},isAcronym:function(){return u(this.text)},isImplicit:function(){return""===this.text&&Boolean(this.implicit)},isKnown:function(){return Object.keys(this.tags).some(t=>!0!==C[t])},setRoot:function(t){let e=t.transforms,r=this.implicit||this.clean;if(this.tags.Plural&&(r=e.toSingular(r,t)),this.tags.Verb&&!this.tags.Negative&&!this.tags.Infinitive){let n=null;this.tags.PastTense?n="PastTense":this.tags.Gerund?n="Gerund":this.tags.PresentTense?n="PresentTense":this.tags.Participle?n="Participle":this.tags.Actor&&(n="Actor"),r=e.toInfinitive(r,t,n)}this.root=r}};const T=/[\s-]/,k=/^[A-Z-]+$/;var N={textOut:function(t,e,r){t=t||{};let n=this.text,s=this.pre,o=this.post;return!0===t.reduced&&(n=this.reduced||""),!0===t.root&&(n=this.root||""),!0===t.implicit&&this.implicit&&(n=this.implicit||""),!0===t.normal&&(n=this.clean||this.text||""),!0===t.root&&(n=this.root||this.reduced||""),!0===t.unicode&&(n=i(n)),!0===t.titlecase&&(this.tags.ProperNoun&&!this.titleCase()||(this.tags.Acronym?n=n.toUpperCase():k.test(n)&&!this.tags.Acronym&&(n=n.toLowerCase()))),!0===t.lowercase&&(n=n.toLowerCase()),!0===t.acronyms&&this.tags.Acronym&&(n=n.replace(/\./g,"")),!0!==t.whitespace&&!0!==t.root||(s="",o=" ",!1!==T.test(this.post)&&!t.last||this.implicit||(o="")),!0!==t.punctuation||t.root||(!0===this.hasPost(".")?o="."+o:!0===this.hasPost("?")?o="?"+o:!0===this.hasPost("!")?o="!"+o:!0===this.hasPost(",")?o=","+o:!0===this.hasEllipses()&&(o="..."+o)),!0!==e&&(s=""),!0!==r&&(o=""),!0===t.abbreviations&&this.tags.Abbreviation&&(o=o.replace(/^\./,"")),s+n+o}};const $={Auxiliary:1,Possessive:1};var V=function(t,e){let r=Object.keys(t.tags);const n=e.tags;return r=r.sort((t,e)=>$[e]||!n[e]?-1:n[e]?n[t]?n[t].lineage.length>n[e].lineage.length?1:n[t].isA.length>n[e].isA.length?-1:0:0:1),r};const I={text:!0,tags:!0,implicit:!0,whitespace:!0,clean:!1,id:!1,index:!1,offset:!1,bestTag:!1};var B={json:function(t,e){t=t||{};let r={};return(t=Object.assign({},I,t)).text&&(r.text=this.text),t.normal&&(r.normal=this.clean),t.tags&&(r.tags=Object.keys(this.tags)),t.clean&&(r.clean=this.clean),(t.id||t.offset)&&(r.id=this.id),t.implicit&&null!==this.implicit&&(r.implicit=this.implicit),t.whitespace&&(r.pre=this.pre,r.post=this.post),t.bestTag&&(r.bestTag=V(this,e)[0]),r}},z=Object.assign({},x,P,F,N,B);function S(){return"undefined"!=typeof window&&window.document}const D=function(t,e){for(t=t.toString();t.length<e;)t+=" ";return t};var M=function(t,e,r){if(S())return void console.log("%c"+D(t.clean,3)+"  + "+e+" ","color: #6accb2;");let n="[33m"+D(t.clean,15)+"[0m + [32m"+e+"[0m ";r&&(n=D(n,35)+" "+r),console.log(n)},G=function(t,e,r){if(S())return void console.log("%c"+D(t.clean,3)+"  - "+e+" ","color: #AB5850;");let n="[33m"+D(t.clean,3)+" [31m - #"+e+"[0m ";r&&(n=D(n,35)+" "+r),console.log(n)},_=t=>t.charAt(0).toUpperCase()+t.substr(1);const q=function(t,e,r,n){let i=n.tags;if(""===e||"."===e||"-"===e)return;if("#"===e[0]&&(e=e.replace(/^#/,"")),e=_(e),!0===t.tags[e])return;const s=n.isVerbose();!0===s&&M(t,e,r),t.tags[e]=!0,!0===i.hasOwnProperty(e)&&(i[e].isA.forEach(e=>{t.tags[e]=!0,!0===s&&M(t,"→ "+e)}),t.unTag(i[e].notA,"←",n))};var L=function(t,e,r,n){if("string"!=typeof e)for(let i=0;i<e.length;i++)q(t,e[i],r,n);else q(t,e,r,n)};const W=/^[a-z]/,U=function(t,e,r,n){const i=n.isVerbose();if("*"===e)return t.tags={},t;var s;e=e.replace(/^#/,""),!0===W.test(e)&&(e=(s=e).charAt(0).toUpperCase()+s.substr(1)),!0===t.tags[e]&&(delete t.tags[e],!0===i&&G(t,e,r));const o=n.tags;if(o[e]){let r=o[e].lineage;for(let e=0;e<r.length;e++)!0===t.tags[r[e]]&&(delete t.tags[r[e]],!0===i&&G(t," - "+r[e]))}return t};var H=function(t,e,r,n){if("string"!=typeof e&&e)for(let i=0;i<e.length;i++)U(t,e[i],r,n);else U(t,e,r,n)};const R=function(t,e,r){const n=r.tags;if("#"===e[0]&&(e=e.replace(/^#/,"")),void 0===n[e])return!0;let i=n[e].notA||[];for(let e=0;e<i.length;e++)if(!0===t.tags[i[e]])return!1;return void 0===n[e].isA||R(t,n[e].isA,r)};var Q=R,Z={tag:function(t,e,r){return L(this,t,e,r),this},tagSafe:function(t,e,r){return Q(this,t,r)&&L(this,t,e,r),this},unTag:function(t,e,r){return H(this,t,e,r),this},canBe:function(t,e){return Q(this,t,e)}};class J{constructor(t=""){t=String(t);let r=A(t);this.text=r.text||"",this.clean=r.clean,this.reduced=r.reduced,this.root=null,this.implicit=null,this.pre=r.pre||"",this.post=r.post||"",this.tags={},this.prev=null,this.next=null,this.id=e(r.clean),this.isA="Term",r.alias&&(this.alias=r.alias)}set(t){let e=A(t);return this.text=e.text,this.clean=e.clean,this.reduced=e.reduced,this.root=null,this.implicit=null,this}}J.prototype.clone=function(){let t=new J(this.text);return t.pre=this.pre,t.post=this.post,t.clean=this.clean,t.reduced=this.reduced,t.root=this.root,t.implicit=this.implicit,t.tags=Object.assign({},this.tags),t},Object.assign(J.prototype,z),Object.assign(J.prototype,Z);var Y=J,K={terms:function(t){if(0===this.length)return[];if(this.cache.terms)return void 0!==t?this.cache.terms[t]:this.cache.terms;let e=[this.pool.get(this.start)];for(let r=0;r<this.length-1;r+=1){let n=e[e.length-1].next;if(null===n){console.error("Compromise error: Linked list broken in phrase '"+this.start+"'");break}let i=this.pool.get(n);if(e.push(i),void 0!==t&&t===r)return e[t]}return void 0===t&&(this.cache.terms=e),void 0!==t?e[t]:e},clone:function(t){if(t){let t=this.buildFrom(this.start,this.length);return t.cache=this.cache,t}let e=this.terms().map(t=>t.clone());return e.forEach((t,r)=>{this.pool.add(t),e[r+1]&&(t.next=e[r+1].id),e[r-1]&&(t.prev=e[r-1].id)}),this.buildFrom(e[0].id,e.length)},lastTerm:function(){let t=this.terms();return t[t.length-1]},hasId:function(t){if(0===this.length||!t)return!1;if(this.start===t)return!0;if(this.cache.terms){let e=this.cache.terms;for(let r=0;r<e.length;r++)if(e[r].id===t)return!0;return!1}let e=this.start;for(let r=0;r<this.length-1;r+=1){let r=this.pool.get(e);if(void 0===r)return console.error(`Compromise error: Linked list broken. Missing term '${e}' in phrase '${this.start}'\n`),!1;if(r.next===t)return!0;e=r.next}return!1},wordCount:function(){return this.terms().filter(t=>""!==t.text).length},fullSentence:function(){let t=this.terms(0);for(;t.prev;)t=this.pool.get(t.prev);let e=t.id,r=1;for(;t.next;)t=this.pool.get(t.next),r+=1;return this.buildFrom(e,r)}};var X={text:function(t={},e,r){"string"==typeof t&&(t="normal"===t?{whitespace:!0,unicode:!0,lowercase:!0,punctuation:!0,acronyms:!0,abbreviations:!0,implicit:!0,normal:!0}:"clean"===t?{titlecase:!1,lowercase:!0,punctuation:!0,whitespace:!0,unicode:!0,implicit:!0,normal:!0}:"reduced"===t?{punctuation:!1,titlecase:!1,lowercase:!0,whitespace:!0,unicode:!0,implicit:!0,reduced:!0}:"implicit"===t?{punctuation:!0,implicit:!0,whitespace:!0,trim:!0}:"root"===t?{titlecase:!1,lowercase:!0,punctuation:!0,whitespace:!0,unicode:!0,implicit:!0,root:!0}:{});let n=this.terms(),i=!1;n[0]&&null===n[0].prev&&null===n[n.length-1].next&&(i=!0);let s=n.reduce((s,o,a)=>{if(0===a&&""===o.text&&null!==o.implicit&&!t.implicit)return s;t.last=r&&a===n.length-1;let l=!0,u=!0;return!1===i&&(0===a&&e&&(l=!1),a===n.length-1&&r&&(u=!1)),s+o.textOut(t,l,u)},"");return!0===i&&r&&(s=s.replace(/ +$/,"")),!0===t.trim&&(s=s.trim()),s}},tt={trim:function(){let t=this.terms();if(t.length>0){t[0].pre=t[0].pre.replace(/^\s+/,"");let e=t[t.length-1];e.post=e.post.replace(/\s+$/,"")}return this}};const et=/[.?!]\s*$/,rt=function(t,e){e[0].pre=t[0].pre;let r=t[t.length-1],n=e[e.length-1];n.post=function(t,e){if(et.test(e))return e+t.match(/\s*$/);return t}(r.post,n.post),r.post="",""===r.post&&(r.post+=" ")};var nt=function(t,e,r){let n=t.terms(),i=e.terms();rt(n,i),function(t,e,r){let n=t[t.length-1],i=e[e.length-1],s=n.next;n.next=e[0].id,i.next=s,s&&(r.get(s).prev=i.id);let o=t[0].id;o&&(e[0].prev=o)}(n,i,t.pool);let s=[t],o=t.start,a=[r];var l;return a=a.concat(r.parents()),a.forEach(t=>{let e=t.list.filter(t=>t.hasId(o));s=s.concat(e)}),s=(l=s).filter((t,e)=>l.indexOf(t)===e),s.forEach(t=>{t.length+=e.length}),t.cache={},t};const it=/ /;var st=function(t,e,r){const n=t.start;let i=e.terms();!function(t){let e=t[t.length-1];!1===it.test(e.post)&&(e.post+=" ")}(i),function(t,e,r){let n=r[r.length-1];n.next=t.start;let i=t.pool,s=i.get(t.start);s.prev&&(i.get(s.prev).next=e.start);r[0].prev=t.terms(0).prev,t.terms(0).prev=n.id}(t,e,i);let s=[t],o=[r];var a;return o=o.concat(r.parents()),o.forEach(t=>{let r=t.list.filter(t=>t.hasId(n)||t.hasId(e.start));s=s.concat(r)}),s=(a=s).filter((t,e)=>a.indexOf(t)===e),s.forEach(t=>{t.length+=e.length,t.start===n&&(t.start=e.start),t.cache={}}),t};var ot=function(t,e){let r=e.pool(),n=t.terms(),i=r.get(n[0].prev)||{},s=r.get(n[n.length-1].next)||{};n[0].implicit&&i.implicit&&(i.set(i.implicit),i.post+=" "),function(t,e,r,n){let i=t.parents();i.push(t),i.forEach(t=>{let i=t.list.find(t=>t.hasId(e));i&&(i.length-=r,i.start===e&&(i.start=n.id),i.cache={})}),t.list=t.list.filter(t=>!(!t.start||!t.length))}(e,t.start,t.length,s),i&&(i.next=s.id),s&&(s.prev=i.id)},at={append:function(t,e){return nt(this,t,e),this},prepend:function(t,e){return st(this,t,e),this},delete:function(t){return ot(this,t),this},replace:function(t,e){let r=this.length;nt(this,t,e);let n=this.buildFrom(this.start,this.length);n.length=r,ot(n,e)},splitOn:function(t){let e=this.terms(),r={before:null,match:null,after:null},n=e.findIndex(e=>e.id===t.start);if(-1===n)return r;let i=e.slice(0,n);i.length>0&&(r.before=this.buildFrom(i[0].id,i.length));let s=e.slice(n,n+t.length);s.length>0&&(r.match=this.buildFrom(s[0].id,s.length));let o=e.slice(n+t.length,e.length);return o.length>0&&(r.after=this.buildFrom(o[0].id,o.length,this.pool)),r}},lt={json:function(t={},e){let r={};return t.text&&(r.text=this.text()),t.normal&&(r.normal=this.text("normal")),t.clean&&(r.clean=this.text("clean")),t.reduced&&(r.reduced=this.text("reduced")),t.implicit&&(r.implicit=this.text("implicit")),t.root&&(r.root=this.text("root")),t.trim&&(r.text&&(r.text=r.text.trim()),r.normal&&(r.normal=r.normal.trim()),r.reduced&&(r.reduced=r.reduced.trim())),t.terms&&(!0===t.terms&&(t.terms={}),r.terms=this.terms().map(r=>r.json(t.terms,e))),r}},ut={lookAhead:function(t){t||(t=".*");let e=this.pool,r=[];const n=function(t){let i=e.get(t);i&&(r.push(i),i.prev&&n(i.next))};let i=this.terms(),s=i[i.length-1];return n(s.next),0===r.length?[]:this.buildFrom(r[0].id,r.length).match(t)},lookBehind:function(t){t||(t=".*");let e=this.pool,r=[];const n=function(t){let i=e.get(t);i&&(r.push(i),i.prev&&n(i.prev))};let i=e.get(this.start);return n(i.prev),0===r.length?[]:this.buildFrom(r[r.length-1].id,r.length).match(t)}},ht=Object.assign({},K,X,tt,at,lt,ut);var ct=function(t,e){if(0===e.length)return!0;for(let t=0;t<e.length;t+=1){let r=e[t];if(!0!==r.optional&&!0!==r.negative&&!0===r.start&&t>0)return!0;if(!0===r.anything&&!0===r.negative)return!0}return!1},ft=w((function(t,e){e.getGreedy=function(t,e){let r=Object.assign({},t.regs[t.r],{start:!1,end:!1}),n=t.t;for(;t.t<t.terms.length;t.t+=1){if(e&&t.terms[t.t].doesMatch(e,t.start_i+t.t,t.phrase_length))return t.t;let i=t.t-n+1;if(void 0!==r.max&&i===r.max)return t.t;if(!1===t.terms[t.t].doesMatch(r,t.start_i+t.t,t.phrase_length))return void 0!==r.min&&i<r.min?null:t.t}return t.t},e.greedyTo=function(t,e){let r=t.t;if(!e)return t.terms.length;for(;r<t.terms.length;r+=1)if(!0===t.terms[r].doesMatch(e,t.start_i+r,t.phrase_length))return r;return null},e.isEndGreedy=function(t,e){if(!0===t.end&&!0===t.greedy&&e.start_i+e.t<e.phrase_length-1){let r=Object.assign({},t,{end:!1});if(!0===e.terms[e.t].doesMatch(r,e.start_i+e.t,e.phrase_length))return!0}return!1},e.doOrBlock=function(t,r=0){let n=t.regs[t.r],i=!1;for(let e=0;e<n.choices.length;e+=1){let s=n.choices[e];if(i=s.every((e,n)=>{let i=0,s=t.t+n+r+i;if(void 0===t.terms[s])return!1;let o=t.terms[s].doesMatch(e,s+t.start_i,t.phrase_length);if(!0===o&&!0===e.greedy)for(let r=1;r<t.terms.length;r+=1){let n=t.terms[s+r];if(n){if(!0!==n.doesMatch(e,t.start_i+r,t.phrase_length))break;i+=1}}return r+=i,o}),i){r+=s.length;break}}return i&&!0===n.greedy?e.doOrBlock(t,r):r},e.doAndBlock=function(t){let e=0;return!0===t.regs[t.r].choices.every(r=>{let n=r.every((e,r)=>{let n=t.t+r;return void 0!==t.terms[n]&&t.terms[n].doesMatch(e,n,t.phrase_length)});return!0===n&&r.length>e&&(e=r.length),n})&&e},e.getGroup=function(t,e,r){if(t.groups[t.groupId])return t.groups[t.groupId];const n=t.terms[e].id;return t.groups[t.groupId]={group:String(r),start:n,length:0},t.groups[t.groupId]}}));var pt=function(t,r,n,i){let s={t:0,terms:t,r:0,regs:r,groups:{},start_i:n,phrase_length:i,hasGroup:!1,groupId:null,previousGroup:null};for(;s.r<r.length;s.r+=1){let t=r[s.r];if(s.hasGroup="string"==typeof t.named||"number"==typeof t.named,!0===s.hasGroup){const n=r[s.r-1];n&&n.named===t.named&&s.previousGroup?s.groupId=s.previousGroup:(s.groupId=e(t.named),s.previousGroup=s.groupId)}if(!s.terms[s.t]){if(!1===r.slice(s.r).some(t=>!t.optional))break;return null}if(!0===t.anything&&!0===t.greedy){let e=ft.greedyTo(s,r[s.r+1]);if(null===e||0===e)return null;if(void 0!==t.min&&e-s.t<t.min)return null;if(void 0!==t.max&&e-s.t>t.max){s.t=s.t+t.max;continue}if(!0===s.hasGroup){ft.getGroup(s,s.t,t.named).length=e-s.t}s.t=e;continue}if(void 0!==t.choices&&"or"===t.operator){let e=ft.doOrBlock(s);if(e){if(!0===t.negative)return null;if(!0===s.hasGroup){ft.getGroup(s,s.t,t.named).length+=e}s.t+=e;continue}if(!t.optional)return null}if(void 0!==t.choices&&"and"===t.operator){let e=ft.doAndBlock(s);if(e){if(!0===t.negative)return null;if(!0===s.hasGroup){ft.getGroup(s,s.t,t.named).length+=e}s.t+=e;continue}if(!t.optional)return null}let n=s.terms[s.t],o=n.doesMatch(t,s.start_i+s.t,s.phrase_length);if(!0===t.anything||!0===o||ft.isEndGreedy(t,s)){let e=s.t;if(t.optional&&r[s.r+1]&&t.negative)continue;if(t.optional&&r[s.r+1]){let e=n.doesMatch(r[s.r+1],s.start_i+s.t,s.phrase_length);if(t.negative||e){let t=s.terms[s.t+1];t&&t.doesMatch(r[s.r+1],s.start_i+s.t,s.phrase_length)||(s.r+=1)}}if(s.t+=1,!0===t.end&&s.t!==s.terms.length&&!0!==t.greedy)return null;if(!0===t.greedy){if(s.t=ft.getGreedy(s,r[s.r+1]),null===s.t)return null;if(t.min&&t.min>s.t)return null;if(!0===t.end&&s.start_i+s.t!==i)return null}if(!0===s.hasGroup){const r=ft.getGroup(s,e,t.named);s.t>1&&t.greedy?r.length+=s.t-e:r.length++}}else{if(t.negative){let e=Object.assign({},t);if(e.negative=!1,!0===s.terms[s.t].doesMatch(e,s.start_i+s.t,s.phrase_length))return null}if(!0!==t.optional){if(s.terms[s.t].isImplicit()&&r[s.r-1]&&s.terms[s.t+1]){if(s.terms[s.t-1]&&s.terms[s.t-1].implicit===r[s.r-1].word)return null;if(s.terms[s.t+1].doesMatch(t,s.start_i+s.t,s.phrase_length)){s.t+=2;continue}}return null}}}return{match:s.terms.slice(0,s.t),groups:s.groups}};var dt=function(t,e,r){if(!r||0===r.length)return r;if(e.some(t=>t.end)){let e=t[t.length-1];r=r.filter(({match:t})=>-1!==t.indexOf(e))}return r};const mt=/(?:^|\s)([\!\[\^]*(?:<[^<]*>)?\/.*?[^\\\/]\/[\?\]\+\*\$~]*)(?:\s|$)/,gt=/([\!\[\^]*(?:<[^<]*>)?\([^\)]+[^\\\)]\)[\?\]\+\*\$~]*)(?:\s|$)/,vt=/ /g,bt=t=>/^[\!\[\^]*(<[^<]*>)?\//.test(t)&&/\/[\?\]\+\*\$~]*$/.test(t),yt=function(t){return t=(t=t.map(t=>t.trim())).filter(t=>t)};var At=function(t){let e=t.split(mt),r=[];e.forEach(t=>{bt(t)?r.push(t):r=r.concat(t.split(gt))}),r=yt(r);let n=[];return r.forEach(t=>{(t=>/^[\!\[\^]*(<[^<]*>)?\(/.test(t)&&/\)[\?\]\+\*\$~]*$/.test(t))(t)||bt(t)?n.push(t):n=n.concat(t.split(vt))}),n=yt(n),n};const wt=/\{([0-9]+,?[0-9]*)\}/,xt=/&&/,Pt=new RegExp(/^<\s*?(\S+)\s*?>/),jt=function(t){return t[t.length-1]},Et=function(t){return t[0]},Ot=function(t){return t.substr(1)},Ct=function(t){return t.substr(0,t.length-1)},Ft=function(t){return t=Ot(t),t=Ct(t)},Tt=function(t){let e={};for(let r=0;r<2;r+=1){if("$"===jt(t)&&(e.end=!0,t=Ct(t)),"^"===Et(t)&&(e.start=!0,t=Ot(t)),("["===Et(t)||"]"===jt(t))&&(e.named=!0,"["===Et(t)?e.groupType="]"===jt(t)?"single":"start":e.groupType="end",t=(t=t.replace(/^\[/,"")).replace(/\]$/,""),"<"===Et(t))){const r=Pt.exec(t);r.length>=2&&(e.named=r[1],t=t.replace(r[0],""))}if("+"===jt(t)&&(e.greedy=!0,t=Ct(t)),"*"!==t&&"*"===jt(t)&&"\\*"!==t&&(e.greedy=!0,t=Ct(t)),"?"===jt(t)&&(e.optional=!0,t=Ct(t)),"!"===Et(t)&&(e.negative=!0,t=Ot(t)),"("===Et(t)&&")"===jt(t)){xt.test(t)?(e.choices=t.split(xt),e.operator="and"):(e.choices=t.split("|"),e.operator="or"),e.choices[0]=Ot(e.choices[0]);let r=e.choices.length-1;e.choices[r]=Ct(e.choices[r]),e.choices=e.choices.map(t=>t.trim()),e.choices=e.choices.filter(t=>t),e.choices=e.choices.map(t=>t.split(/ /g).map(Tt)),t=""}if("/"===Et(t)&&"/"===jt(t))return t=Ft(t),e.regex=new RegExp(t),e;if("~"===Et(t)&&"~"===jt(t))return t=Ft(t),e.soft=!0,e.word=t,e}return!0===wt.test(t)&&(t=t.replace(wt,(t,r)=>{let n=r.split(/,/g);return 1===n.length?(e.min=Number(n[0]),e.max=Number(n[0])):(e.min=Number(n[0]),e.max=Number(n[1]||999)),e.greedy=!0,e.optional=!0,""})),"#"===Et(t)?(e.tag=Ot(t),e.tag=(r=e.tag).charAt(0).toUpperCase()+r.substr(1),e):"@"===Et(t)?(e.method=Ot(t),e):"."===t?(e.anything=!0,e):"*"===t?(e.anything=!0,e.greedy=!0,e.optional=!0,e):(t&&(t=(t=t.replace("\\*","*")).replace("\\.","."),e.word=t.toLowerCase()),e);var r};var kt=Tt;var Nt=function(t,e={}){return t.filter(t=>t.groupType).length>0&&(t=function(t){let e,r=!1,n=-1;for(let i=0;i<t.length;i++){const s=t[i];"single"!==s.groupType||!0!==s.named?("start"===s.groupType&&(r=!0,"string"==typeof s.named||"number"==typeof s.named?e=s.named:(n+=1,e=n)),r&&(s.named=e),"end"===s.groupType&&(r=!1)):(n+=1,s.named=n)}return t}(t)),e.fuzzy||(t=function(t){return t.map(t=>{if(void 0!==t.choices&&!0===t.choices.every(t=>{if(1!==t.length)return!1;let e=t[0];return void 0!==e.word&&!0!==e.negative&&!0!==e.optional&&!0!==e.method})){let e={};t.choices.forEach(t=>{e[t[0].word]=!0}),t.fastOr=e,delete t.choices}return t})}(t)),t};var $t=function(t,e={}){if(null==t||""===t)return[];if("object"==typeof t){if(function(t){return"[object Array]"===Object.prototype.toString.call(t)}(t)){if(0===t.length||!t[0])return[];if("object"==typeof t[0])return t;if("string"==typeof t[0])return function(t){return[{choices:t.map(t=>[{word:t}]),operator:"or"}]}(t)}return t&&"Doc"===t.isA?function(t){if(!t||!t.list||!t.list[0])return[];let e=[];return t.list.forEach(t=>{let r=[];t.terms().forEach(t=>{r.push(t.id)}),e.push(r)}),[{idBlocks:e}]}(t):[]}"number"==typeof t&&(t=String(t));let r=At(t);return r=r.map(t=>kt(t)),r=Nt(r,e),r=function(t,e){return!0===e.fuzzy&&(e.fuzzy=.85),"number"==typeof e.fuzzy&&(t=t.map(t=>(e.fuzzy>0&&t.word&&(t.fuzzy=e.fuzzy),t.choices&&t.choices.forEach(t=>{t.forEach(t=>{t.fuzzy=e.fuzzy})}),t))),t}(r,e),r};var Vt=function(t,e){let r=[],n=e[0].idBlocks;for(let e=0;e<t.length;e+=1)n.forEach(n=>{if(0===n.length)return;n.every((r,n)=>t[e+n].id===r)&&(r.push({match:t.slice(e,e+n.length)}),e+=n.length-1)});return r};var It=function(t,e,r=!1){if("string"==typeof e&&(e=$t(e)),!0===ct(t,e))return[];const n=e.filter(t=>!0!==t.optional&&!0!==t.negative).length;let i=t.terms(),s=[];if(e[0].idBlocks){let t=Vt(i,e);if(t&&t.length>0)return dt(i,e,t)}if(!0===e[0].start){let t=pt(i,e,0,i.length);return t&&t.match&&t.match.length>0&&(t.match=t.match.filter(t=>t),s.push(t)),dt(i,e,s)}for(let t=0;t<i.length&&!(t+n>i.length);t+=1){let n=pt(i.slice(t),e,t,i.length);if(n&&n.match&&n.match.length>0&&(t+=n.match.length-1,n.match=n.match.filter(t=>t),s.push(n),!0===r))return dt(i,e,s)}return dt(i,e,s)};var Bt=function(t,e){let r={};It(t,e).forEach(({match:t})=>{t.forEach(t=>{r[t.id]=!0})});let n=t.terms(),i=[],s=[];return n.forEach(t=>{!0!==r[t.id]?s.push(t):s.length>0&&(i.push(s),s=[])}),s.length>0&&i.push(s),i},zt={match:function(t,e=!1){let r=It(this,t,e);return r=r.map(({match:t,groups:e})=>{let r=this.buildFrom(t[0].id,t.length,e);return r.cache.terms=t,r}),r},has:function(t){return It(this,t,!0).length>0},not:function(t){let e=Bt(this,t);return e=e.map(t=>this.buildFrom(t[0].id,t.length)),e},canBe:function(t,e){let r=[],n=this.terms(),i=!1;for(let s=0;s<n.length;s+=1){let o=n[s].canBe(t,e);!0===o&&(!0===i?r[r.length-1].push(n[s]):r.push([n[s]]),i=o)}return r=r.filter(t=>t.length>0).map(t=>this.buildFrom(t[0].id,t.length)),r}};class St{constructor(t,e,r){this.start=t,this.length=e,this.isA="Phrase",Object.defineProperty(this,"pool",{enumerable:!1,writable:!0,value:r}),Object.defineProperty(this,"cache",{enumerable:!1,writable:!0,value:{}}),Object.defineProperty(this,"groups",{enumerable:!1,writable:!0,value:{}})}}St.prototype.buildFrom=function(t,e,r){let n=new St(t,e,this.pool);return r&&Object.keys(r).length>0?n.groups=r:n.groups=this.groups,n},Object.assign(St.prototype,zt),Object.assign(St.prototype,ht);const Dt={term:"terms"};Object.keys(Dt).forEach(t=>St.prototype[t]=St.prototype[Dt[t]]);var Mt=St;class Gt{constructor(t={}){Object.defineProperty(this,"words",{enumerable:!1,value:t})}add(t){return this.words[t.id]=t,this}get(t){return this.words[t]}remove(t){delete this.words[t]}merge(t){return Object.assign(this.words,t.words),this}stats(){return{words:Object.keys(this.words).length}}}Gt.prototype.clone=function(){let t=Object.keys(this.words).reduce((t,e)=>{let r=this.words[e].clone();return t[r.id]=r,t},{});return new Gt(t)};var _t=Gt;var qt=t=>{t.forEach((e,r)=>{r>0&&(e.prev=t[r-1].id),t[r+1]&&(e.next=t[r+1].id)})};const Lt=/(\S.+?[.!?\u203D\u2E18\u203C\u2047-\u2049])(?=\s+|$)/g,Wt=/\S/,Ut=/[ .][A-Z]\.? *$/i,Ht=/(?:\u2026|\.{2,}) *$/,Rt=/((?:\r?\n|\r)+)/,Qt=/[a-z0-9\u00C0-\u00FF\u00a9\u00ae\u2000-\u3300\ud000-\udfff]/i,Zt=/^\s+/,Jt=function(t,e){if(!0===Ut.test(t))return!1;if(!0===Ht.test(t))return!1;if(!1===Qt.test(t))return!1;let r=t.replace(/[.!?\u203D\u2E18\u203C\u2047-\u2049] *$/,"").split(" "),n=r[r.length-1].toLowerCase();return!e.hasOwnProperty(n)};var Yt=function(t,e){let r=e.cache.abbreviations;t=t||"";let n=[],i=[];if(!(t=String(t))||"string"!=typeof t||!1===Wt.test(t))return n;let s=function(t){let e=[],r=t.split(Rt);for(let t=0;t<r.length;t++){let n=r[t].split(Lt);for(let t=0;t<n.length;t++)e.push(n[t])}return e}(t=t.replace(" "," "));for(let t=0;t<s.length;t++){let e=s[t];if(void 0!==e&&""!==e){if(!1===Wt.test(e)){if(i[i.length-1]){i[i.length-1]+=e;continue}if(s[t+1]){s[t+1]=e+s[t+1];continue}}i.push(e)}}for(let t=0;t<i.length;t++){let e=i[t];i[t+1]&&!1===Jt(e,r)?i[t+1]=e+(i[t+1]||""):e&&e.length>0&&(n.push(e),i[t]="")}if(0===n.length)return[t];for(let t=1;t<n.length;t+=1){let e=n[t].match(Zt);null!==e&&(n[t-1]+=e[0],n[t]=n[t].replace(Zt,""))}return n};const Kt=/\S/,Xt=/^[!?.]+$/,te=/(\S+)/,ee=/[a-z] ?\/ ?[a-z]*$/;let re=[".","?","!",":",";","-","–","—","--","...","(",")","[","]",'"',"'","`"];re=re.reduce((t,e)=>(t[e]=!0,t),{});const ne=function(t){if(!0===/^(re|un|micro|macro|trans|bi|mono|over)-?[^aeiou]./.test(t))return!1;if(!0===/^([a-z\u00C0-\u00FF/]+)(-|–|—)(like|ish|less|able)/i.test(t))return!1;if(!0===/^([a-z\u00C0-\u00FF`"'/]+)(-|–|—)([a-z0-9\u00C0-\u00FF].*)/i.test(t))return!0;return!0===/^([0-9]{1,4})(-|–|—)([a-z\u00C0-\u00FF`"'/-]+$)/i.test(t)},ie=function(t){let e=[];const r=t.split(/[-–—]/);let n="-",i=t.match(/[-–—]/);i&&i[0]&&(n=i);for(let t=0;t<r.length;t++)t===r.length-1?e.push(r[t]):e.push(r[t]+n);return e};var se=function(t){let e=[],r=[];if("number"==typeof(t=t||"")&&(t=String(t)),function(t){return"[object Array]"===Object.prototype.toString.call(t)}(t))return t;const n=t.split(te);for(let t=0;t<n.length;t++)!0!==ne(n[t])?r.push(n[t]):r=r.concat(ie(n[t]));let i="";for(let t=0;t<r.length;t++){let n=r[t];!0===Kt.test(n)&&!1===re.hasOwnProperty(n)&&!1===Xt.test(n)?(e.length>0?(e[e.length-1]+=i,e.push(n)):e.push(i+n),i=""):i+=n}return i&&(0===e.length&&(e[0]=""),e[e.length-1]+=i),e=function(t){for(let e=1;e<t.length-1;e++)ee.test(t[e])&&(t[e-1]+=t[e]+t[e+1],t[e]=null,t[e+1]=null);return t}(e),e=function(t){const e=/^[0-9]{1,4}(:[0-9][0-9])?([a-z]{1,2})? ?(-|–|—) ?$/,r=/^[0-9]{1,4}([a-z]{1,2})? ?$/;for(let n=0;n<t.length-1;n+=1)t[n+1]&&e.test(t[n])&&r.test(t[n+1])&&(t[n]=t[n]+t[n+1],t[n+1]=null);return t}(e),e=e.filter(t=>t),e};var oe=function(t="",e,r){let n=null;return"string"!=typeof t&&("number"==typeof t?t=String(t):function(t){return"[object Array]"===Object.prototype.toString.call(t)}(t)&&(n=t)),n=n||Yt(t,e),n=n.map(t=>se(t)),r=r||new _t,n.map(t=>{t=t.map(t=>{let e=new Y(t);return r.add(e),e}),qt(t);let e=new Mt(t[0].id,t.length,r);return e.cache.terms=t,e})};var ae=function(t,e){let r=new _t;return t.map((t,n)=>{let i=t.terms.map((i,s)=>{let o=new Y(i.text);return o.pre=void 0!==i.pre?i.pre:"",void 0===i.post&&(i.post=" ",s>=t.terms.length-1&&(i.post=". ",n>=t.terms.length-1&&(i.post="."))),o.post=void 0!==i.post?i.post:" ",i.tags&&i.tags.forEach(t=>o.tag(t,"",e)),r.add(o),o});return qt(i),new Mt(i[0].id,i.length,r)})};const le=["Person","Place","Organization"];var ue={Noun:{notA:["Verb","Adjective","Adverb"]},Singular:{isA:"Noun",notA:"Plural"},ProperNoun:{isA:"Noun"},Person:{isA:["ProperNoun","Singular"],notA:["Place","Organization","Date"]},FirstName:{isA:"Person"},MaleName:{isA:"FirstName",notA:["FemaleName","LastName"]},FemaleName:{isA:"FirstName",notA:["MaleName","LastName"]},LastName:{isA:"Person",notA:["FirstName"]},NickName:{isA:"Person",notA:["FirstName","LastName"]},Honorific:{isA:"Noun",notA:["FirstName","LastName","Value"]},Place:{isA:"Singular",notA:["Person","Organization"]},Country:{isA:["Place","ProperNoun"],notA:["City"]},City:{isA:["Place","ProperNoun"],notA:["Country"]},Region:{isA:["Place","ProperNoun"]},Address:{isA:"Place"},Organization:{isA:["Singular","ProperNoun"],notA:["Person","Place"]},SportsTeam:{isA:"Organization"},School:{isA:"Organization"},Company:{isA:"Organization"},Plural:{isA:"Noun",notA:["Singular"]},Uncountable:{isA:"Noun"},Pronoun:{isA:"Noun",notA:le},Actor:{isA:"Noun",notA:le},Activity:{isA:"Noun",notA:["Person","Place"]},Unit:{isA:"Noun",notA:le},Demonym:{isA:["Noun","ProperNoun"],notA:le},Possessive:{isA:"Noun"}},he={Verb:{notA:["Noun","Adjective","Adverb","Value"]},PresentTense:{isA:"Verb",notA:["PastTense","FutureTense"]},Infinitive:{isA:"PresentTense",notA:["PastTense","Gerund"]},Imperative:{isA:"Infinitive"},Gerund:{isA:"PresentTense",notA:["PastTense","Copula","FutureTense"]},PastTense:{isA:"Verb",notA:["FutureTense"]},FutureTense:{isA:"Verb"},Copula:{isA:"Verb"},Modal:{isA:"Verb",notA:["Infinitive"]},PerfectTense:{isA:"Verb",notA:"Gerund"},Pluperfect:{isA:"Verb"},Participle:{isA:"PastTense"},PhrasalVerb:{isA:"Verb"},Particle:{isA:"PhrasalVerb"},Auxiliary:{notA:["Noun","Adjective","Value"]}},ce={Value:{notA:["Verb","Adjective","Adverb"]},Ordinal:{isA:"Value",notA:["Cardinal"]},Cardinal:{isA:"Value",notA:["Ordinal"]},Fraction:{isA:"Value",notA:["Noun"]},RomanNumeral:{isA:"Cardinal",notA:["Ordinal","TextValue"]},TextValue:{isA:"Value",notA:["NumericValue"]},NumericValue:{isA:"Value",notA:["TextValue"]},Money:{isA:"Cardinal"},Percent:{isA:"Value"}};const fe=["Noun","Verb","Adjective","Adverb","Value","QuestionWord"];var pe={Adjective:{notA:["Noun","Verb","Adverb","Value"]},Comparable:{isA:["Adjective"]},Comparative:{isA:["Adjective"]},Superlative:{isA:["Adjective"],notA:["Comparative"]},NumberRange:{},Adverb:{notA:["Noun","Verb","Adjective","Value"]},Date:{notA:["Verb","Adverb","Preposition","Adjective"]},Month:{isA:["Date","Singular"],notA:["Year","WeekDay","Time"]},WeekDay:{isA:["Date","Noun"]},Timezone:{isA:["Date","Noun"],notA:["Adjective","ProperNoun"]},Time:{isA:["Date"],notA:["AtMention"]},Determiner:{notA:fe},Conjunction:{notA:fe},Preposition:{notA:fe},QuestionWord:{notA:["Determiner"]},Currency:{isA:["Noun"]},Expression:{notA:["Noun","Adjective","Verb","Adverb"]},Abbreviation:{},Url:{notA:["HashTag","PhoneNumber","Verb","Adjective","Value","AtMention","Email"]},PhoneNumber:{notA:["HashTag","Verb","Adjective","Value","AtMention","Email"]},HashTag:{},AtMention:{isA:["Noun"],notA:["HashTag","Verb","Adjective","Value","Email"]},Emoji:{notA:["HashTag","Verb","Adjective","Value","AtMention"]},Emoticon:{notA:["HashTag","Verb","Adjective","Value","AtMention"]},Email:{notA:["HashTag","Verb","Adjective","Value","AtMention"]},Acronym:{notA:["Plural","RomanNumeral"]},Negative:{notA:["Noun","Adjective","Value"]},Condition:{notA:["Verb","Adjective","Noun","Value"]}};const de={Noun:"blue",Verb:"green",Negative:"green",Date:"red",Value:"red",Adjective:"magenta",Preposition:"cyan",Conjunction:"cyan",Determiner:"cyan",Adverb:"cyan"};var me=function(t){return Object.keys(t).forEach(e=>{t[e].color?t[e].color=t[e].color:de[e]?t[e].color=de[e]:t[e].isA.some(r=>!!de[r]&&(t[e].color=de[r],!0))}),t};var ge=function(t){return Object.keys(t).forEach(e=>{let r=t[e],n=r.isA.length;for(let e=0;e<n;e++){let n=r.isA[e];t[n]&&(r.isA=r.isA.concat(t[n].isA))}r.isA=function(t){return t.filter((t,e,r)=>r.indexOf(t)===e)}(r.isA)}),t};var ve=function(t){let e=Object.keys(t);return e.forEach(r=>{let n=t[r];n.notA=n.notA||[],n.isA.forEach(e=>{if(t[e]&&t[e].notA){let r="string"==typeof t[e].notA?[t[e].isA]:t[e].notA||[];n.notA=n.notA.concat(r)}});for(let i=0;i<e.length;i++){const s=e[i];-1!==t[s].notA.indexOf(r)&&n.notA.push(s)}n.notA=function(t){return t.filter((t,e,r)=>r.indexOf(t)===e)}(n.notA)}),t};var be=function(t){let e=Object.keys(t);return e.forEach(r=>{let n=t[r];n.lineage=[];for(let i=0;i<e.length;i++)-1!==t[e[i]].isA.indexOf(r)&&n.lineage.push(e[i])}),t};var ye=function(t){return t=function(t){return Object.keys(t).forEach(e=>{let r=t[e];r.isA=r.isA||[],"string"==typeof r.isA&&(r.isA=[r.isA]),r.notA=r.notA||[],"string"==typeof r.notA&&(r.notA=[r.notA])}),t}(t),t=ge(t),t=ve(t),t=me(t),t=be(t)};const Ae=function(t,e){Object.keys(t).forEach(r=>{e[r]=t[r]})};var we=(()=>{let t={};return Ae(ue,t),Ae(he,t),Ae(ce,t),Ae(pe,t),t=ye(t),t})(),xe={},Pe=t=>t;const je={Unit:(t,e)=>{t[e]=["Abbreviation","Unit"]},Cardinal:(t,e)=>{t[e]=["TextValue","Cardinal"]},TextOrdinal:(t,e)=>{t[e]=["Ordinal","TextValue"],t[e+"s"]=["TextValue","Fraction"]},Singular:(t,e,r)=>{t[e]="Singular";let n=r.transforms.toPlural(e,r);t[n]=t[n]||"Plural"},Infinitive:(t,e,r)=>{t[e]="Infinitive";let n=r.transforms.conjugate(e,r),i=Object.keys(n);for(let e=0;e<i.length;e++){let r=n[i[e]];t[r]=t[r]||i[e]}},Comparable:(t,e,r)=>{t[e]="Comparable";let n=r.transforms.adjectives(e),i=Object.keys(n);for(let e=0;e<i.length;e++){let r=n[i[e]];t[r]=t[r]||i[e]}},PhrasalVerb:(t,e,r)=>{t[e]=["PhrasalVerb","Infinitive"];let n=e.split(" "),i=r.transforms.conjugate(n[0],r),s=Object.keys(i);for(let e=0;e<s.length;e++){let o=i[s[e]]+" "+n[1];t[o]=t[o]||["PhrasalVerb",s[e]],r.hasCompound[i[s[e]]]=!0}},Demonym:(t,e,r)=>{t[e]="Demonym";let n=r.transforms.toPlural(e,r);t[n]=t[n]||["Demonym","Plural"]}},Ee=function(t,e,r){Object.keys(t).forEach(n=>{let i=t[n];"Abbreviation"!==i&&"Unit"!==i||(r.cache.abbreviations[n]=!0);let s=n.split(" ");s.length>1&&(r.hasCompound[s[0]]=!0),void 0===je[i]?void 0!==e[n]?("string"==typeof e[n]&&(e[n]=[e[n]]),"string"==typeof i?e[n].push(i):e[n]=e[n].concat(i)):e[n]=i:je[i](e,n,r)})};var Oe=function(t){let e=Object.assign({},xe);return Object.keys(xe).forEach(r=>{let n=xe[r];Object.keys(n).forEach(t=>{n[t]=r}),Ee(n,e,t)}),e},Ce=Ee;var Fe=function(t){let e=t.irregulars.nouns,r=Object.keys(e);for(let n=0;n<r.length;n++){const i=r[n];t.words[i]="Singular",t.words[e[i]]="Plural"}let n=t.irregulars.verbs,i=Object.keys(n);for(let e=0;e<i.length;e++){const r=i[e];t.words[r]=t.words[r]||"Infinitive";let s=t.transforms.conjugate(r,t);s=Object.assign(s,n[r]),Object.keys(s).forEach(e=>{t.words[s[e]]=t.words[s[e]]||e,"Participle"===t.words[s[e]]&&(t.words[s[e]]=e)})}};const Te={nouns:xe,verbs:xe},ke={conjugate:Pe,adjectives:Pe,toPlural:Pe,toSingular:Pe,toInfinitive:Pe};let Ne=!1;class $e{constructor(){Object.defineProperty(this,"words",{enumerable:!1,value:{},writable:!0}),Object.defineProperty(this,"hasCompound",{enumerable:!1,value:{},writable:!0}),Object.defineProperty(this,"irregulars",{enumerable:!1,value:Te,writable:!0}),Object.defineProperty(this,"tags",{enumerable:!1,value:Object.assign({},we),writable:!0}),Object.defineProperty(this,"transforms",{enumerable:!1,value:ke,writable:!0}),Object.defineProperty(this,"taggers",{enumerable:!1,value:[],writable:!0}),Object.defineProperty(this,"cache",{enumerable:!1,value:{abbreviations:{}}}),this.words=Oe(this),Fe(this)}verbose(t){return Ne=t,this}isVerbose(){return Ne}addWords(t){let e={};Object.keys(t).forEach(r=>{let n=t[r];r=r.toLowerCase().trim(),e[r]=n}),Ce(e,this.words,this)}addConjugations(t){return Object.assign(this.irregulars.verbs,t),this}addPlurals(t){return Object.assign(this.irregulars.nouns,t),this}addTags(t){return t=Object.assign({},t),this.tags=Object.assign(this.tags,t),this.tags=ye(this.tags),this}postProcess(t){return this.taggers.push(t),this}stats(){return{words:Object.keys(this.words).length,plurals:Object.keys(this.irregulars.nouns).length,conjugations:Object.keys(this.irregulars.verbs).length,compounds:Object.keys(this.hasCompound).length,postProcessors:this.taggers.length}}}const Ve=function(t){return JSON.parse(JSON.stringify(t))};$e.prototype.clone=function(){let t=new $e;return t.words=Object.assign({},this.words),t.hasCompound=Object.assign({},this.hasCompound),t.irregulars=Ve(this.irregulars),t.tags=Ve(this.tags),t.transforms=this.transforms,t.taggers=this.taggers,t};var Ie=$e,Be=w((function(t,e){e.all=function(){return this.parents()[0]||this},e.parent=function(){return this.from?this.from:this},e.parents=function(t){let e=[];const r=function(t){t.from&&(e.push(t.from),r(t.from))};return r(this),e=e.reverse(),"number"==typeof t?e[t]:e},e.clone=function(t){let e=this.list.map(e=>e.clone(t));return this.buildFrom(e)},e.wordCount=function(){return this.list.reduce((t,e)=>t+=e.wordCount(),0)},e.wordcount=e.wordCount})),ze=w((function(t,e){e.first=function(t){return void 0===t?this.get(0):this.slice(0,t)},e.last=function(t){if(void 0===t)return this.get(this.list.length-1);let e=this.list.length;return this.slice(e-t,e)},e.slice=function(t,e){let r=this.list.slice(t,e);return this.buildFrom(r)},e.eq=function(t){let e=this.list[t];return void 0===e?this.buildFrom([]):this.buildFrom([e])},e.get=e.eq,e.firstTerms=function(){return this.match("^.")},e.firstTerm=e.firstTerms,e.lastTerms=function(){return this.match(".$")},e.lastTerm=e.lastTerms,e.termList=function(t){let e=[];for(let r=0;r<this.list.length;r++){let n=this.list[r].terms();for(let r=0;r<n.length;r++)if(e.push(n[r]),void 0!==t&&void 0!==e[t])return e[t]}return e};e.groups=function(t){return void 0===t?function(t){let e={};const r={};for(let e=0;e<t.list.length;e++){const n=t.list[e],i=Object.keys(n.groups).map(t=>n.groups[t]);for(let t=0;t<i.length;t++){const{group:e,start:s,length:o}=i[t];r[e]||(r[e]=[]),r[e].push(n.buildFrom(s,o))}}const n=Object.keys(r);for(let i=0;i<n.length;i++){const s=n[i];e[s]=t.buildFrom(r[s])}return e}(this):("number"==typeof t&&(t=String(t)),function(t,e){const r=[];for(let n=0;n<t.list.length;n++){const i=t.list[n];let s=Object.keys(i.groups);s=s.filter(t=>i.groups[t].group===e),s.forEach(t=>{r.push(i.buildFrom(i.groups[t].start,i.groups[t].length))})}return t.buildFrom(r)}(this,t)||this.buildFrom([]))},e.group=e.groups,e.sentences=function(t){let e=[];return this.list.forEach(t=>{e.push(t.fullSentence())}),"number"==typeof t?this.buildFrom([e[t]]):this.buildFrom(e)},e.sentence=e.sentences}));var Se=function(t,e){if(t._cache&&!0===t._cache.set){let{words:r,tags:n}=function(t){let e=[],r=[];return t.forEach(t=>{!0!==t.optional&&!0!==t.negative&&(void 0!==t.tag&&e.push(t.tag),void 0!==t.word&&r.push(t.word))}),{tags:e,words:r}}(e);for(let e=0;e<r.length;e++)if(void 0===t._cache.words[r[e]])return!1;for(let e=0;e<n.length;e++)if(void 0===t._cache.tags[n[e]])return!1}return!0},De=w((function(t,e){e.match=function(t,e={}){"string"!=typeof e&&"number"!=typeof e&&null!==e||(e={group:e});let r=$t(t,e);if(0===r.length)return this.buildFrom([]);if(!1===Se(this,r))return this.buildFrom([]);let n=this.list.reduce((t,e)=>t.concat(e.match(r)),[]);return void 0!==e.group&&null!==e.group&&""!==e.group?this.buildFrom(n).groups(e.group):this.buildFrom(n)},e.not=function(t,e={}){let r=$t(t,e);if(0===r.length||!1===Se(this,r))return this;let n=this.list.reduce((t,e)=>t.concat(e.not(r)),[]);return this.buildFrom(n)},e.matchOne=function(t,e={}){let r=$t(t,e);if(!1===Se(this,r))return this.buildFrom([]);for(let t=0;t<this.list.length;t++){let e=this.list[t].match(r,!0);return this.buildFrom(e)}return this.buildFrom([])},e.if=function(t,e={}){let r=$t(t,e);if(!1===Se(this,r))return this.buildFrom([]);let n=this.list.filter(t=>!0===t.has(r));return this.buildFrom(n)},e.ifNo=function(t,e={}){let r=$t(t,e),n=this.list.filter(t=>!1===t.has(r));return this.buildFrom(n)},e.has=function(t,e={}){let r=$t(t,e);return!1!==Se(this,r)&&this.list.some(t=>!0===t.has(r))},e.lookAhead=function(t,e={}){t||(t=".*");let r=$t(t,e),n=[];return this.list.forEach(t=>{n=n.concat(t.lookAhead(r))}),n=n.filter(t=>t),this.buildFrom(n)},e.lookAfter=e.lookAhead,e.lookBehind=function(t,e={}){t||(t=".*");let r=$t(t,e),n=[];return this.list.forEach(t=>{n=n.concat(t.lookBehind(r))}),n=n.filter(t=>t),this.buildFrom(n)},e.lookBefore=e.lookBehind,e.before=function(t,e={}){let r=$t(t,e),n=this.if(r).list.map(t=>{let e=t.terms().map(t=>t.id),n=t.match(r)[0],i=e.indexOf(n.start);return 0===i||-1===i?null:t.buildFrom(t.start,i)});return n=n.filter(t=>null!==t),this.buildFrom(n)},e.after=function(t,e={}){let r=$t(t,e),n=this.if(r).list.map(t=>{let e=t.terms(),n=e.map(t=>t.id),i=t.match(r)[0],s=n.indexOf(i.start);if(-1===s||!e[s+i.length])return null;let o=e[s+i.length].id,a=t.length-s-i.length;return t.buildFrom(o,a)});return n=n.filter(t=>null!==t),this.buildFrom(n)},e.hasAfter=function(t,e={}){return this.filter(r=>r.lookAfter(t,e).found)},e.hasBefore=function(t,e={}){return this.filter(r=>r.lookBefore(t,e).found)}}));var Me=function(t,e,r,n){let i=[];"string"==typeof t&&(i=t.split(" ")),e.list.forEach(s=>{let o=s.terms();!0===r&&(o=o.filter(r=>r.canBe(t,e.world))),o.forEach((r,s)=>{i.length>1?i[s]&&"."!==i[s]&&r.tag(i[s],n,e.world):r.tag(t,n,e.world)})})},Ge={tag:function(t,e){return t?(Me(t,this,!1,e),this):this},tagSafe:function(t,e){return t?(Me(t,this,!0,e),this):this},unTag:function(t,e){return this.list.forEach(r=>{r.terms().forEach(r=>r.unTag(t,e,this.world))}),this},canBe:function(t){if(!t)return this;let e=this.world,r=this.list.reduce((r,n)=>r.concat(n.canBe(t,e)),[]);return this.buildFrom(r)}},_e={map:function(t){if(!t)return this;let e=this.list.map((e,r)=>{let n=this.buildFrom([e]);n.from=null;let i=t(n,r);return i&&i.list&&i.list[0]?i.list[0]:i});return e=e.filter(t=>t),0===e.length?this.buildFrom(e):"object"!=typeof e[0]||"Phrase"!==e[0].isA?e:this.buildFrom(e)},forEach:function(t,e){return t?(this.list.forEach((r,n)=>{let i=this.buildFrom([r]);!0===e&&(i.from=null),t(i,n)}),this):this},filter:function(t){if(!t)return this;let e=this.list.filter((e,r)=>{let n=this.buildFrom([e]);return n.from=null,t(n,r)});return this.buildFrom(e)},find:function(t){if(!t)return this;let e=this.list.find((e,r)=>{let n=this.buildFrom([e]);return n.from=null,t(n,r)});return e?this.buildFrom([e]):void 0},some:function(t){return t?this.list.some((e,r)=>{let n=this.buildFrom([e]);return n.from=null,t(n,r)}):this},random:function(t){if(!this.found)return this;let e=Math.floor(Math.random()*this.list.length);if(void 0===t){let t=[this.list[e]];return this.buildFrom(t)}return e+t>this.length&&(e=this.length-t,e=e<0?0:e),this.slice(e,e+t)}};var qe=function(t,e,r){let n=function(t,e=[]){let r={};return t.forEach((t,n)=>{let i=!0;void 0!==e[n]&&(i=e[n]);let s=function(t){return t.split(/[ -]/g)}(t=(t=(t||"").toLowerCase()).replace(/[,;.!?]+$/,"")).map(t=>t.trim());r[s[0]]=r[s[0]]||{},1===s.length?r[s[0]].value=i:(r[s[0]].more=r[s[0]].more||[],r[s[0]].more.push({rest:s.slice(1),value:i}))}),r}(t,e),i=[];for(let t=0;t<r.list.length;t++){const e=r.list[t];let s=e.terms().map(t=>t.reduced);for(let t=0;t<s.length;t++)void 0!==n[s[t]]&&(void 0!==n[s[t]].more&&n[s[t]].more.forEach(r=>{if(void 0===s[t+r.rest.length])return;!0===r.rest.every((e,r)=>e===s[t+r+1])&&i.push({id:e.terms()[t].id,value:r.value,length:r.rest.length+1})}),void 0!==n[s[t]].value&&i.push({id:e.terms()[t].id,value:n[s[t]].value,length:1}))}return i},Le=w((function(t,e){e.lookup=function(t){let e=[],r=(n=t)&&"[object Object]"===Object.prototype.toString.call(n);var n;!0===r&&(t=Object.keys(t).map(r=>(e.push(t[r]),r))),"string"==typeof t&&(t=[t]),!0!==this._cache.set&&this.cache();let i=qe(t,e,this),s=this.list[0];if(!0===r){let t={};return i.forEach(e=>{t[e.value]=t[e.value]||[],t[e.value].push(s.buildFrom(e.id,e.length))}),Object.keys(t).forEach(e=>{t[e]=this.buildFrom(t[e])}),t}return i=i.map(t=>s.buildFrom(t.id,t.length)),this.buildFrom(i)},e.lookUp=e.lookup})),We={cache:function(t){t=t||{};let e={},r={};return this._cache.words=e,this._cache.tags=r,this._cache.set=!0,this.list.forEach((n,i)=>{n.cache=n.cache||{},n.terms().forEach(n=>{e[n.reduced]&&!e.hasOwnProperty(n.reduced)||(e[n.reduced]=e[n.reduced]||[],e[n.reduced].push(i),Object.keys(n.tags).forEach(t=>{r[t]=r[t]||[],r[t].push(i)}),t.root&&(n.setRoot(this.world),e[n.root]=[i]))})}),this},uncache:function(){return this._cache={},this.list.forEach(t=>{t.cache={}}),this.parents().forEach(t=>{t._cache={},t.list.forEach(t=>{t.cache={}})}),this}};var Ue={replaceWith:function(t,e={}){return t?(!0===e&&(e={keepTags:!0}),!1===e&&(e={keepTags:!1}),e=e||{},this.uncache(),this.list.forEach(r=>{let n,i=t;if("function"==typeof t&&(i=t(r)),i&&"object"==typeof i&&"Doc"===i.isA)n=i.list,this.pool().merge(i.pool());else{if("string"!=typeof i)return;{!1!==e.keepCase&&r.terms(0).isTitleCase()&&(i=(s=i).charAt(0).toUpperCase()+s.substr(1)),n=oe(i,this.world,this.pool());let t=this.buildFrom(n);t.tagger(),n=t.list}}var s;if(!0===e.keepTags){let t=r.json({terms:{tags:!0}}).terms;n[0].terms().forEach((e,r)=>{t[r]&&e.tagSafe(t[r].tags,"keptTag",this.world)})}r.replace(n[0],this)}),this):this.delete()},replace:function(t,e,r){return void 0===e?this.replaceWith(t,r):(this.match(t).replaceWith(e,r),this)}},He=w((function(t,e){const r=function(t){return t&&"[object Object]"===Object.prototype.toString.call(t)},n=function(t,e){let r=oe(t,e.world)[0],n=e.buildFrom([r]);return n.tagger(),e.list=n.list,e};e.append=function(t=""){return t?this.found?(this.uncache(),this.list.forEach(e=>{let n;r(t)&&"Doc"===t.isA?n=t.list[0].clone():"string"==typeof t&&(n=oe(t,this.world,this.pool())[0]),this.buildFrom([n]).tagger(),e.append(n,this)}),this):n(t,this):this},e.insertAfter=e.append,e.insertAt=e.append,e.prepend=function(t){return t?this.found?(this.uncache(),this.list.forEach(e=>{let n;r(t)&&"Doc"===t.isA?n=t.list[0].clone():"string"==typeof t&&(n=oe(t,this.world,this.pool())[0]),this.buildFrom([n]).tagger(),e.prepend(n,this)}),this):n(t,this):this},e.insertBefore=e.prepend,e.concat=function(){this.uncache();let t=this.list.slice(0);for(let e=0;e<arguments.length;e++){let r=arguments[e];if("string"==typeof r){let e=oe(r,this.world);t=t.concat(e)}else"Doc"===r.isA?t=t.concat(r.list):"Phrase"===r.isA&&t.push(r)}return this.buildFrom(t)},e.delete=function(t){this.uncache();let e=this;return t&&(e=this.match(t)),e.list.forEach(t=>t.delete(this)),this},e.remove=e.delete}));const Re={clean:!0,reduced:!0,root:!0};var Qe={text:function(t){t=t||{};let e=!1;0===this.parents().length&&(e=!0),("root"===t||"object"==typeof t&&t.root)&&this.list.forEach(t=>{t.terms().forEach(t=>{null===t.root&&t.setRoot(this.world)})});let r=this.list.reduce((r,n,i)=>{const s=!e&&0===i,o=!e&&i===this.list.length-1;return r+n.text(t,s,o)},"");return!0!==Re[t]&&!0!==t.reduced&&!0!==t.clean&&!0!==t.root||(r=r.trim()),r}};var Ze=function(t,e,r){let n=function(t){let e=0,r=0,n={};return t.termList().forEach(t=>{n[t.id]={index:r,start:e+t.pre.length,length:t.text.length},e+=t.pre.length+t.text.length+t.post.length,r+=1}),n}(t.all());(r.terms.index||r.index)&&e.forEach(t=>{t.terms.forEach(t=>{t.index=n[t.id].index}),t.index=t.terms[0].index}),(r.terms.offset||r.offset)&&e.forEach(t=>{t.terms.forEach(t=>{t.offset=n[t.id]||{}}),t.offset={index:t.terms[0].offset.index,start:t.terms[0].offset.start-t.text.indexOf(t.terms[0].text),length:t.text.length}})},Je=w((function(t,e){const r={text:!0,terms:!0,trim:!0};e.json=function(t={}){if("number"==typeof t&&this.list[t])return this.list[t].json(r);!0===(t=function(t){return(t=Object.assign({},r,t)).unique&&(t.reduced=!0),t.offset&&(t.text=!0,t.terms&&!0!==t.terms||(t.terms={}),t.terms.offset=!0),(t.index||t.terms.index)&&(t.terms=!0===t.terms?{}:t.terms,t.terms.id=!0),t}(t)).root&&this.list.forEach(t=>{t.terms().forEach(t=>{null===t.root&&t.setRoot(this.world)})});let e=this.list.map(e=>e.json(t,this.world));if((t.terms.offset||t.offset||t.terms.index||t.index)&&Ze(this,e,t),t.frequency||t.freq||t.count){let t={};this.list.forEach(e=>{let r=e.text("reduced");t[r]=t[r]||0,t[r]+=1}),this.list.forEach((r,n)=>{e[n].count=t[r.text("reduced")]})}if(t.unique){let t={};e=e.filter(e=>!0!==t[e.reduced]&&(t[e.reduced]=!0,!0))}return e},e.data=e.json})),Ye=w((function(t){const e="[0m",r=function(t,e){for(t=t.toString();t.length<e;)t+=" ";return t};const n={green:"#7f9c6c",red:"#914045",blue:"#6699cc",magenta:"#6D5685",cyan:"#2D85A8",yellow:"#e6d7b3",black:"#303b50"},i={green:function(t){return"[32m"+t+e},red:function(t){return"[31m"+t+e},blue:function(t){return"[34m"+t+e},magenta:function(t){return"[35m"+t+e},cyan:function(t){return"[36m"+t+e},yellow:function(t){return"[33m"+t+e},black:function(t){return"[30m"+t+e}};t.exports=function(t){return"undefined"!=typeof window&&window.document?(function(t){let e=t.world.tags;t.list.forEach(t=>{console.log('\n%c"'+t.text()+'"',"color: #e6d7b3;"),t.terms().forEach(t=>{let i=Object.keys(t.tags),s=t.text||"-";t.implicit&&(s="["+t.implicit+"]");let o="'"+s+"'";o=r(o,8);let a=i.find(t=>e[t]&&e[t].color),l="steelblue";e[a]&&(l=e[a].color,l=n[l]),console.log(`   ${o}  -  %c${i.join(", ")}`,`color: ${l||"steelblue"};`)})})}(t),t):(console.log(i.blue("=====")),t.list.forEach(e=>{console.log(i.blue("  -----")),e.terms().forEach(e=>{let n=Object.keys(e.tags),s=e.text||"-";e.implicit&&(s="["+e.implicit+"]"),s=i.yellow(s);let o="'"+s+"'";o=r(o,18);let a=i.blue("  ｜ ")+o+"  - "+function(t,e){return(t=t.map(t=>{if(!e.tags.hasOwnProperty(t))return t;const r=e.tags[t].color||"blue";return i[r](t)})).join(", ")}(n,t.world);console.log(a)})}),console.log(""),t)}}));var Ke=function(t){let e=t.json({text:!1,terms:!1,reduced:!0}),r={};e.forEach(t=>{r[t.reduced]||(t.count=0,r[t.reduced]=t),r[t.reduced].count+=1});let n=Object.keys(r).map(t=>r[t]);return n.sort((t,e)=>t.count>e.count?-1:t.count<e.count?1:0),n},Xe={debug:function(){return Ye(this),this},out:function(t){if("text"===t)return this.text();if("normal"===t)return this.text("normal");if("json"===t)return this.json();if("offset"===t||"offsets"===t)return this.json({offset:!0});if("array"===t)return this.json({terms:!1}).map(t=>t.text).filter(t=>t);if("freq"===t||"frequency"===t)return Ke(this);if("terms"===t){let t=[];return this.json({text:!1,terms:{text:!0}}).forEach(e=>{let r=e.terms.map(t=>t.text);r=r.filter(t=>t),t=t.concat(r)}),t}return"tags"===t?this.list.map(t=>t.terms().reduce((t,e)=>(t[e.clean||e.implicit]=Object.keys(e.tags),t),{})):"debug"===t?(Ye(this),this):this.text()}};const tr={alpha:(t,e)=>{let r=t.text("clean"),n=e.text("clean");return r<n?-1:r>n?1:0},length:(t,e)=>{let r=t.text().trim().length,n=e.text().trim().length;return r<n?1:r>n?-1:0},wordCount:(t,e)=>{let r=t.wordCount(),n=e.wordCount();return r<n?1:r>n?-1:0}};tr.alphabetical=tr.alpha,tr.wordcount=tr.wordCount;const er={index:!0,sequence:!0,seq:!0,sequential:!0,chron:!0,chronological:!0};var rr={sort:function(t){return"freq"===(t=t||"alpha")||"frequency"===t||"topk"===t?function(t){let e={};const r={case:!0,punctuation:!1,whitespace:!0,unicode:!0};return t.list.forEach(t=>{let n=t.text(r);e[n]=e[n]||0,e[n]+=1}),t.list.sort((t,n)=>{let i=e[t.text(r)],s=e[n.text(r)];return i<s?1:i>s?-1:0}),t}(this):er.hasOwnProperty(t)?function(t){let e={};return t.json({terms:{offset:!0}}).forEach(t=>{e[t.terms[0].id]=t.terms[0].offset.start}),t.list=t.list.sort((t,r)=>e[t.start]>e[r.start]?1:e[t.start]<e[r.start]?-1:0),t}(this):"function"==typeof(t=tr[t]||t)?(this.list=this.list.sort(t),this):this},reverse:function(){let t=[].concat(this.list);return t=t.reverse(),this.buildFrom(t)},unique:function(){let t=[].concat(this.list),e={};return t=t.filter(t=>{let r=t.text("reduced").trim()||t.text("implicit").trim();return!0!==e.hasOwnProperty(r)&&(e[r]=!0,!0)}),this.buildFrom(t)}};const nr=/[\[\]{}⟨⟩:,،、‒–—―…‹›«»‐\-;\/⁄·*\•^†‡°¡¿※№÷×ºª%‰=‱¶§~|‖¦©℗®℠™¤₳฿]/g,ir=/['‘’“”"′″‴]+/g;var sr={whitespace:function(t){let e=t.list.map(t=>t.terms());e.forEach((t,r)=>{t.forEach((n,i)=>{!0!==n.hasDash()?(n.pre=n.pre.replace(/\s/g,""),n.post=n.post.replace(/\s/g,""),(t.length-1!==i||e[r+1])&&(n.implicit&&!0===Boolean(n.text)||!0!==n.hasHyphen()&&(n.post+=" "))):n.post=" - "})})},punctuation:function(t){t.forEach(t=>{!0===t.hasHyphen()&&(t.post=" "),t.pre=t.pre.replace(nr,""),t.post=t.post.replace(nr,""),t.post=t.post.replace(/\.\.\./,""),!0===/!/.test(t.post)&&(t.post=t.post.replace(/!/g,""),t.post="!"+t.post),!0===/\?/.test(t.post)&&(t.post=t.post.replace(/[\?!]*/,""),t.post="?"+t.post)})},unicode:function(t){t.forEach(t=>{!0!==t.isImplicit()&&(t.text=i(t.text))})},quotations:function(t){t.forEach(t=>{t.post=t.post.replace(ir,""),t.pre=t.pre.replace(ir,"")})},adverbs:function(t){t.match("#Adverb").not("(not|nary|seldom|never|barely|almost|basically|so)").remove()},abbreviations:function(t){t.list.forEach(t=>{let e=t.terms();e.forEach((t,r)=>{!0===t.tags.Abbreviation&&e[r+1]&&(t.post=t.post.replace(/^\./,""))})})}};const or={whitespace:!0,unicode:!0,punctuation:!0,emoji:!0,acronyms:!0,abbreviations:!0,case:!1,contractions:!1,parentheses:!1,quotations:!1,adverbs:!1,possessives:!1,verbs:!1,nouns:!1,honorifics:!1},ar={light:{},medium:{case:!0,contractions:!0,parentheses:!0,quotations:!0,adverbs:!0}};ar.heavy=Object.assign({},ar.medium,{possessives:!0,verbs:!0,nouns:!0,honorifics:!0});var lr={normalize:function(t){"string"==typeof(t=t||{})&&(t=ar[t]||{}),t=Object.assign({},or,t),this.uncache();let e=this.termList();return t.case&&this.toLowerCase(),t.whitespace&&sr.whitespace(this),t.unicode&&sr.unicode(e),t.punctuation&&sr.punctuation(e),t.emoji&&this.remove("(#Emoji|#Emoticon)"),t.acronyms&&this.acronyms().strip(),t.abbreviations&&sr.abbreviations(this),(t.contraction||t.contractions)&&this.contractions().expand(),t.parentheses&&this.parentheses().unwrap(),(t.quotations||t.quotes)&&sr.quotations(e),t.adverbs&&sr.adverbs(this),(t.possessive||t.possessives)&&this.possessives().strip(),t.verbs&&this.verbs().toInfinitive(),(t.nouns||t.plurals)&&this.nouns().toSingular(),t.honorifics&&this.remove("#Honorific"),this}},ur=w((function(t,e){e.splitOn=function(t){if(!t){return this.parent().splitOn(this)}let e=$t(t),r=[];return this.list.forEach(t=>{let n=t.match(e);if(0===n.length)return void r.push(t);let i=t;n.forEach(t=>{let e=i.splitOn(t);e.before&&r.push(e.before),e.match&&r.push(e.match),i=e.after}),i&&r.push(i)}),this.buildFrom(r)},e.splitAfter=function(t){if(!t){return this.parent().splitAfter(this)}let e=$t(t),r=[];return this.list.forEach(t=>{let n=t.match(e);if(0===n.length)return void r.push(t);let i=t;n.forEach(t=>{let e=i.splitOn(t);e.before&&e.match?(e.before.length+=e.match.length,r.push(e.before)):e.match&&r.push(e.match),i=e.after}),i&&r.push(i)}),this.buildFrom(r)},e.split=e.splitAfter,e.splitBefore=function(t){if(!t){return this.parent().splitBefore(this)}let e=$t(t),r=[];return this.list.forEach(t=>{let n=t.match(e);if(0===n.length)return void r.push(t);let i=t;n.forEach(t=>{let e=i.splitOn(t);e.before&&r.push(e.before),e.match&&e.after&&(e.match.length+=e.after.length),i=e.match}),i&&r.push(i)}),this.buildFrom(r)},e.segment=function(t,e){t=t||{},e=e||{text:!0};let r=this,n=Object.keys(t);return n.forEach(t=>{r=r.splitOn(t)}),r.list.forEach(e=>{for(let r=0;r<n.length;r+=1)if(e.has(n[r]))return void(e.segment=t[n[r]])}),r.list.map(t=>{let r=t.json(e);return r.segment=t.segment||null,r})}}));const hr=function(t,e){let r=t.world;return t.list.forEach(t=>{t.terms().forEach(t=>t[e](r))}),t};var cr={toLowerCase:function(){return hr(this,"toLowerCase")},toUpperCase:function(){return hr(this,"toUpperCase")},toTitleCase:function(){return hr(this,"toTitleCase")},toCamelCase:function(){return this.list.forEach(t=>{let e=t.terms();e.forEach((t,r)=>{0!==r&&t.toTitleCase(),r!==e.length-1&&(t.post="")})}),this}},fr=w((function(t,e){e.pre=function(t,e){return void 0===t?this.list[0].terms(0).pre:(this.list.forEach(r=>{let n=r.terms(0);!0===e?n.pre+=t:n.pre=t}),this)},e.post=function(t,e){return void 0===t?this.list.map(t=>{let e=t.terms();return e[e.length-1].post}):(this.list.forEach(r=>{let n=r.terms(),i=n[n.length-1];!0===e?i.post+=t:i.post=t}),this)},e.trim=function(){return this.list=this.list.map(t=>t.trim()),this},e.hyphenate=function(){return this.list.forEach(t=>{let e=t.terms();e.forEach((t,r)=>{0!==r&&(t.pre=""),e[r+1]&&(t.post="-")})}),this},e.dehyphenate=function(){const t=/(-|–|—)/;return this.list.forEach(e=>{e.terms().forEach(e=>{t.test(e.post)&&(e.post=" ")})}),this},e.deHyphenate=e.dehyphenate,e.toQuotations=function(t,e){return t=t||'"',e=e||'"',this.list.forEach(r=>{let n=r.terms();n[0].pre=t+n[0].pre;let i=n[n.length-1];i.post=e+i.post}),this},e.toQuotation=e.toQuotations,e.toParentheses=function(t,e){return t=t||"(",e=e||")",this.list.forEach(r=>{let n=r.terms();n[0].pre=t+n[0].pre;let i=n[n.length-1];i.post=e+i.post}),this}})),pr={join:function(t){this.uncache();let e=this.list[0],r=e.length,n={};for(let r=1;r<this.list.length;r++){const i=this.list[r];n[i.start]=!0;let s=e.lastTerm();t&&(s.post+=t),s.next=i.start,i.terms(0).prev=s.id,e.length+=i.length,e.cache={}}let i=e.length-r;return this.parents().forEach(t=>{t.list.forEach(t=>{let r=t.terms();for(let n=0;n<r.length;n++)if(r[n].id===e.start){t.length+=i;break}t.cache={}}),t.list=t.list.filter(t=>!0!==n[t.start])}),this.buildFrom([e])}};const dr=/[,\)"';:\-–—\.…]/,mr=function(t,e){if(!t.found)return;let r=t.termList();for(let t=0;t<r.length-1;t++){const e=r[t];if(dr.test(e.post))return}r.forEach(t=>{t.implicit=t.clean}),r[0].text+=e,r.slice(1).forEach(t=>{t.text=""});for(let t=0;t<r.length-1;t++){const e=r[t];e.post=e.post.replace(/ /,"")}};var gr={contract:function(){let t=this.not("@hasContraction"),e=t.match("(we|they|you) are");return mr(e,"'re"),e=t.match("(he|she|they|it|we|you) will"),mr(e,"'ll"),e=t.match("(he|she|they|it|we) is"),mr(e,"'s"),e=t.match("#Person is"),mr(e,"'s"),e=t.match("#Person would"),mr(e,"'d"),e=t.match("(is|was|had|would|should|could|do|does|have|has|can) not"),mr(e,"n't"),e=t.match("(i|we|they) have"),mr(e,"'ve"),e=t.match("(would|should|could) have"),mr(e,"'ve"),e=t.match("i am"),mr(e,"'m"),e=t.match("going to"),this}},vr=Object.assign({},Be,ze,De,Ge,_e,Le,We,Ue,He,Qe,Je,Xe,rr,lr,ur,cr,fr,pr,gr);let br={};[["terms","."],["hyphenated","@hasHyphen ."],["adjectives","#Adjective"],["hashTags","#HashTag"],["emails","#Email"],["emoji","#Emoji"],["emoticons","#Emoticon"],["atMentions","#AtMention"],["urls","#Url"],["adverbs","#Adverb"],["pronouns","#Pronoun"],["conjunctions","#Conjunction"],["prepositions","#Preposition"]].forEach(t=>{br[t[0]]=function(e){let r=this.match(t[1]);return"number"==typeof e&&(r=r.get(e)),r}}),br.emojis=br.emoji,br.atmentions=br.atMentions,br.words=br.terms,br.phoneNumbers=function(t){let e=this.splitAfter("@hasComma");return e=e.match("#PhoneNumber+"),"number"==typeof t&&(e=e.get(t)),e},br.money=function(t){let e=this.match("#Money #Currency?");return"number"==typeof t&&(e=e.get(t)),e},br.places=function(t){let e=this.match("(#City && @hasComma) (#Region|#Country)"),r=this.not(e).splitAfter("@hasComma");return r=r.concat(e),r.sort("index"),r=r.match("#Place+"),"number"==typeof t&&(r=r.get(t)),r},br.organizations=function(t){let e=this.clauses();return e=e.match("#Organization+"),"number"==typeof t&&(e=e.get(t)),e},br.entities=function(t){let e=this.clauses(),r=e.people();r=r.concat(e.places()),r=r.concat(e.organizations());return r=r.not(["someone","man","woman","mother","brother","sister","father"]),r.sort("sequence"),"number"==typeof t&&(r=r.get(t)),r},br.things=br.entities,br.topics=br.entities;var yr=br;const Ar=/^(under|over)-?/,wr=function(t,e,r){let n=r.words,i=t[e].reduced+" "+t[e+1].reduced;return void 0!==n[i]&&!0===n.hasOwnProperty(i)?(t[e].tag(n[i],"lexicon-two",r),t[e+1].tag(n[i],"lexicon-two",r),1):e+2<t.length&&(i+=" "+t[e+2].reduced,void 0!==n[i]&&!0===n.hasOwnProperty(i))?(t[e].tag(n[i],"lexicon-three",r),t[e+1].tag(n[i],"lexicon-three",r),t[e+2].tag(n[i],"lexicon-three",r),2):e+3<t.length&&(i+=" "+t[e+3].reduced,void 0!==n[i]&&!0===n.hasOwnProperty(i))?(t[e].tag(n[i],"lexicon-four",r),t[e+1].tag(n[i],"lexicon-four",r),t[e+2].tag(n[i],"lexicon-four",r),t[e+3].tag(n[i],"lexicon-four",r),3):0};var xr=function(t,e){let r=e.words,n=e.hasCompound;for(let i=0;i<t.length;i+=1){let s=t[i].clean;if(!0===n[s]&&i+1<t.length){let r=wr(t,i,e);if(r>0){i+=r;continue}}if(void 0===r[s]||!0!==r.hasOwnProperty(s))if(s===t[i].reduced||!0!==r.hasOwnProperty(t[i].reduced)){if(!0===Ar.test(s)){let n=s.replace(Ar,"");!0===r.hasOwnProperty(n)&&t[i].tag(r[n],"noprefix-lexicon",e)}}else t[i].tag(r[t[i].reduced],"lexicon",e);else t[i].tag(r[s],"lexicon",e)}return t};var Pr=function(t){let e=t.termList();return xr(e,t.world),t.world.taggers.forEach(e=>{e(t)}),t};var jr=function(t){class e extends t{stripPeriods(){return this.termList().forEach(t=>{!0===t.tags.Abbreviation&&t.next&&(t.post=t.post.replace(/^\./,""));let e=t.text.replace(/\./,"");t.set(e)}),this}addPeriods(){return this.termList().forEach(t=>{t.post=t.post.replace(/^\./,""),t.post="."+t.post}),this}}return e.prototype.unwrap=e.prototype.stripPeriods,t.prototype.abbreviations=function(t){let r=this.match("#Abbreviation");return"number"==typeof t&&(r=r.get(t)),new e(r.list,this,this.world)},t};const Er=/\./;var Or=function(t){class e extends t{stripPeriods(){return this.termList().forEach(t=>{let e=t.text.replace(/\./g,"");t.set(e)}),this}addPeriods(){return this.termList().forEach(t=>{let e=t.text.replace(/\./g,"");e=e.split("").join("."),!1===Er.test(t.post)&&(e+="."),t.set(e)}),this}}return e.prototype.unwrap=e.prototype.stripPeriods,e.prototype.strip=e.prototype.stripPeriods,t.prototype.acronyms=function(t){let r=this.match("#Acronym");return"number"==typeof t&&(r=r.get(t)),new e(r.list,this,this.world)},t};var Cr=function(t){return t.prototype.clauses=function(e){let r=this.if("@hasComma").notIf("@hasComma @hasComma").notIf("@hasComma . .? (and|or) .").notIf("(#City && @hasComma) #Country").notIf("(#WeekDay && @hasComma) #Date").notIf("(#Date && @hasComma) #Year").notIf("@hasComma (too|also)$").match("@hasComma"),n=this.splitAfter(r),i=n.quotations();n=n.splitOn(i);let s=n.parentheses();n=n.splitOn(s);let o=n.if("#Copula #Adjective #Conjunction (#Pronoun|#Determiner) #Verb").match("#Conjunction");n=n.splitBefore(o);let a=n.if("if .{2,9} then .").match("then");n=n.splitBefore(a),n=n.splitBefore("as well as ."),n=n.splitBefore("such as ."),n=n.splitBefore("in addition to ."),n=n.splitAfter("@hasSemicolon"),n=n.splitAfter("@hasDash");let l=n.filter(t=>t.wordCount()>5&&t.match("#Verb+").length>=2);if(l.found){let t=l.splitAfter("#Noun .* #Verb .* #Noun+");n=n.splitOn(t.eq(0))}return"number"==typeof e&&(n=n.get(e)),new t(n.list,this,this.world)},t};var Fr=function(t){class e extends t{constructor(t,e,r){super(t,e,r),this.contracted=null}expand(){return this.list.forEach(t=>{let e=t.terms(),r=e[0].isTitleCase();e.forEach((t,r)=>{t.set(t.implicit||t.text),t.implicit=void 0,r<e.length-1&&""===t.post&&(t.post+=" ")}),r&&e[0].toTitleCase()}),this}}return t.prototype.contractions=function(t){let r=this.match("@hasContraction+");return"number"==typeof t&&(r=r.get(t)),new e(r.list,this,this.world)},t.prototype.expanded=t.prototype.isExpanded,t.prototype.contracted=t.prototype.isContracted,t};var Tr=function(t){const e=function(t){let e=t.splitAfter("@hasComma").splitOn("(and|or) not?").not("(and|or) not?"),r=t.match("[.] (and|or)",0);return{things:e,conjunction:t.match("(and|or) not?"),beforeLast:r,hasOxford:r.has("@hasComma")}};class r extends t{conjunctions(){return this.match("(and|or)")}parts(){return this.splitAfter("@hasComma").splitOn("(and|or) not?")}items(){return e(this).things}add(t){return this.forEach(r=>{let n=e(r).beforeLast;n.append(t),n.termList(0).addPunctuation(",")}),this}remove(t){return this.items().if(t).remove()}hasOxfordComma(){return this.filter(t=>e(t).hasOxford)}addOxfordComma(){let t=this.items(),e=t.eq(t.length-2);return e.found&&!1===e.has("@hasComma")&&e.post(", "),this}removeOxfordComma(){let t=this.items(),e=t.eq(t.length-2);return e.found&&!0===e.has("@hasComma")&&e.post(" "),this}}return r.prototype.things=r.prototype.items,t.prototype.lists=function(t){let e=this.if("@hasComma+ .? (and|or) not? ."),n=e.match("(#Noun|#Adjective|#Determiner|#Article)+ #Conjunction not? (#Article|#Determiner)? #Adjective? #Noun+").if("#Noun"),i=e.match("(#Adjective|#Adverb)+ #Conjunction not? #Adverb? #Adjective+"),s=e.match("(#Verb|#Adverb)+ #Conjunction not? #Adverb? #Verb+"),o=n.concat(i);return o=o.concat(s),o=o.if("@hasComma"),"number"==typeof t&&(o=e.get(t)),new r(o.list,this,this.world)},t};var kr=function(t){return!0===t.has("#Plural")||!0!==t.has("(#Pronoun|#Place|#Value|#Person|#Uncountable|#Month|#WeekDay|#Holiday|#Possessive)")};const Nr={hour:"an",heir:"an",heirloom:"an",honest:"an",honour:"an",honor:"an",uber:"an"},$r={a:!0,e:!0,f:!0,h:!0,i:!0,l:!0,m:!0,n:!0,o:!0,r:!0,s:!0,x:!0},Vr=[/^onc?e/i,/^u[bcfhjkqrstn][aeiou]/i,/^eul/i];var Ir=function(t){if(t.has("#Person")||t.has("#Place"))return"";if(t.has("#Plural"))return"the";let e=t.text("normal").trim();if(Nr.hasOwnProperty(e))return Nr[e];let r=e.substr(0,1);if(t.has("^@isAcronym")&&$r.hasOwnProperty(r))return"an";for(let t=0;t<Vr.length;t++)if(Vr[t].test(e))return"a";return/^[aeiou]/i.test(e)?"an":"a"};var Br={isSingular:[/(ax|test)is$/i,/(octop|vir|radi|nucle|fung|cact|stimul)us$/i,/(octop|vir)i$/i,/(rl)f$/i,/(alias|status)$/i,/(bu)s$/i,/(al|ad|at|er|et|ed|ad)o$/i,/(ti)um$/i,/(ti)a$/i,/sis$/i,/(?:(^f)fe|(lr)f)$/i,/hive$/i,/(^aeiouy|qu)y$/i,/(x|ch|ss|sh|z)$/i,/(matr|vert|ind|cort)(ix|ex)$/i,/(m|l)ouse$/i,/(m|l)ice$/i,/(antenn|formul|nebul|vertebr|vit)a$/i,/.sis$/i,/^(?!talis|.*hu)(.*)man$/i],isPlural:[/(antenn|formul|nebul|vertebr|vit)ae$/i,/(octop|vir|radi|nucle|fung|cact|stimul)i$/i,/men$/i,/.tia$/i,/(m|l)ice$/i]};const zr=/s$/;var Sr=function(t){return!Br.isSingular.find(e=>e.test(t))&&(!0===zr.test(t)||(!!Br.isPlural.find(e=>e.test(t))||null))};const Dr={he:"his",she:"hers",they:"theirs",we:"ours",i:"mine",you:"yours",her:"hers",their:"theirs",our:"ours",my:"mine",your:"yours"};var Mr=function(t){let e=t.text("text").trim();return Dr.hasOwnProperty(e)?(t.replaceWith(Dr[e],!0),void t.tag("Possessive","toPossessive")):/s$/.test(e)?(e+="'",t.replaceWith(e,!0),void t.tag("Possessive","toPossessive")):(e+="'s",t.replaceWith(e,!0),void t.tag("Possessive","toPossessive"))};var Gr=function(t){let e={main:t};if(t.has("#Noun (of|by|for) .")){let r=t.splitAfter("[#Noun+]",0);e.main=r.eq(0),e.post=r.eq(1)}return e};var _r={json:function(t){let e=null;"number"==typeof t&&(e=t,t=null),t=t||{text:!0,normal:!0,trim:!0,terms:!0};let r=[];return this.forEach(e=>{let n=e.json(t)[0];n.article=Ir(e),r.push(n)}),null!==e?r[e]:r},adjectives:function(){let t=this.lookAhead("^(that|who|which)? (was|is|will)? be? #Adverb? #Adjective+");return t=t.concat(this.lookBehind("#Adjective+ #Adverb?$")),t=t.match("#Adjective"),t.sort("index")},isPlural:function(){return this.if("#Plural")},hasPlural:function(){return this.filter(t=>kr(t))},toPlural:function(t){let e=this.world.transforms.toPlural;return this.forEach(r=>{if(r.has("#Plural")||!1===kr(r))return;let n=Gr(r).main,i=n.text("reduced");if((n.has("#Singular")||!0!==Sr(i))&&(i=e(i,this.world),n.replace(i).tag("#Plural"),t)){let t=n.lookBefore("(an|a) #Adjective?$").not("#Adjective");!0===t.found&&t.remove()}}),this},toSingular:function(t){let e=this.world.transforms.toSingular;return this.forEach(r=>{if(r.has("^#Singular+$")||!1===kr(r))return;let n=Gr(r).main,i=n.text("reduced");if((n.has("#Plural")||!0===Sr(i))&&(i=e(i,this.world),n.replace(i).tag("#Singular"),t)){let t=r,e=r.lookBefore("#Adjective");e.found&&(t=e);let n=Ir(t);t.insertBefore(n)}}),this},toPossessive:function(){return this.forEach(t=>{Mr(t)}),this}};var qr=function(t){class e extends t{}return Object.assign(e.prototype,_r),t.prototype.nouns=function(t,r={}){let n=this.match("(#City && @hasComma) (#Region|#Country)"),i=this.not(n).splitAfter("@hasComma");i=i.concat(n);let s=i.quotations();return s.found&&(i=i.splitOn(s.eq(0))),i=i.match("#Noun+ (of|by)? the? #Noun+?"),!0!==r.keep_anaphora&&(i=i.not("#Pronoun"),i=i.not("(there|these)"),i=i.not("(#Month|#WeekDay)"),i=i.not("(my|our|your|their|her|his)")),i=i.not("(of|for|by|the)$"),"number"==typeof t&&(i=i.get(t)),new e(i.list,this,this.world)},t};const Lr=/\(/,Wr=/\)/;var Ur=function(t){class e extends t{unwrap(){return this.list.forEach(t=>{let e=t.terms(0);e.pre=e.pre.replace(Lr,"");let r=t.lastTerm();r.post=r.post.replace(Wr,"")}),this}}return t.prototype.parentheses=function(t){let r=[];return this.list.forEach(t=>{let e=t.terms();for(let n=0;n<e.length;n+=1){const i=e[n];if(Lr.test(i.pre))for(let s=n;s<e.length;s+=1)if(Wr.test(e[s].post)){let e=s-n+1;r.push(t.buildFrom(i.id,e)),n=s;break}}}),"number"==typeof t?(r=r[t]?[r[t]]:[],new e(r,this,this.world)):new e(r,this,this.world)},t};var Hr=function(t){class e extends t{constructor(t,e,r){super(t,e,r),this.contracted=null}strip(){return this.list.forEach(t=>{t.terms().forEach(t=>{let e=t.text.replace(/'s$/,"");t.set(e||t.text)})}),this}}return t.prototype.possessives=function(t){let r=this.match("#Noun+? #Possessive");return"number"==typeof t&&(r=r.get(t)),new e(r.list,this,this.world)},t};const Rr={'"':'"',"＂":"＂","'":"'","“":"”","‘":"’","‟":"”","‛":"’","„":"”","⹂":"”","‚":"’","«":"»","‹":"›","‵":"′","‶":"″","‷":"‴","〝":"〞","`":"´","〟":"〞"},Qr=RegExp("("+Object.keys(Rr).join("|")+")");var Zr=function(t){class e extends t{unwrap(){return this}}return t.prototype.quotations=function(t){let r=[];return this.list.forEach(t=>{let e=t.terms();for(let n=0;n<e.length;n+=1){const i=e[n];if(Qr.test(i.pre)){let s=(i.pre.match(Qr)||[])[0],o=Rr[s];for(let s=n;s<e.length;s+=1)if(-1!==e[s].post.indexOf(o)){let e=s-n+1;r.push(t.buildFrom(i.id,e)),n=s;break}}}}),"number"==typeof t?(r=r[t]?[r[t]]:[],new e(r,this,this.world)):new e(r,this,this.world)},t.prototype.quotes=t.prototype.quotations,t};var Jr=function(t,e){let r=t.verb,n=r.text("reduced");if(r.has("#Infinitive"))return n;let i=null;return r.has("#PastTense")?i="PastTense":r.has("#Gerund")?i="Gerund":r.has("#PresentTense")?i="PresentTense":r.has("#Participle")?i="Participle":r.has("#Actor")&&(i="Actor"),e.transforms.toInfinitive(n,e,i)};var Yr=function(t){let e=t.verb;if(e.has("(are|were|does)")||t.auxiliary.has("(are|were|does)"))return!0;if(e.has("(is|am|do|was)")||t.auxiliary.has("(is|am|do|was)"))return!1;let r=function(t){return t.lookBehind("#Noun+").last()}(e);return!!r.has("(we|they|you)")||(!!r.has("#Plural")||!r.has("#Singular")&&null)};var Kr=function(t,e){let r=t.verb;if(!t.negative.found){if(t.auxiliary.found)return t.auxiliary.eq(0).append("not"),void(t.auxiliary.has("#Modal have not")&&t.auxiliary.replace("have not","not have"));if(r.has("(#Copula|will|has|had|do)"))r.append("not");else{if(r.has("#PastTense")){let n=Jr(t,e);return r.replaceWith(n,!0),void r.prepend("did not")}if(r.has("#PresentTense")){let n=Jr(t,e);return r.replaceWith(n,!0),void(Yr(t)?r.prepend("do not"):r.prepend("does not"))}if(r.has("#Gerund")){let n=Jr(t,e);return r.replaceWith(n,!0),void r.prepend("not")}Yr(t)?r.prepend("does not"):r.prepend("do not")}}};var Xr=function(t){let e=t.lookBehind(),r=e.nouns(null,{keep_anaphora:!0}).last();return r.found||(r=e.match("(that|this|each)").last(),r=r.tag("#Noun").nouns()),r};var tn=function(t){let e={adverb:t.match("#Adverb+"),negative:t.match("#Negative"),auxiliary:t.match("#Auxiliary+").not("(#Negative|#Adverb)"),particle:t.match("#Particle"),verb:t.match("#Verb+").not("(#Adverb|#Negative|#Auxiliary|#Particle)"),original:t,subject:Xr(t)};if(!e.verb.found)return Object.keys(e).forEach(t=>{e[t]=e[t].not(".")}),e.verb=t,e;if(e.adverb&&e.adverb.found){let r=e.adverb.text("reduced")+"$";t.has(r)&&(e.adverbAfter=!0)}return e};var en=t=>{let e=!1,r=Yr(t),n=t.negative.found;t.verb.lookBehind("(i|we) (#Adverb|#Verb)?$").found&&(e=!0);let i={PastTense:"was",PresentTense:"is",FutureTense:"will be",Infinitive:"is",Gerund:"being",Actor:"",PerfectTense:"been",Pluperfect:"been"};return!0===e&&(i.PresentTense="am",i.Infinitive="am"),r&&(i.PastTense="were",i.PresentTense="are",i.Infinitive="are"),n&&(i.PastTense+=" not",i.PresentTense+=" not",i.FutureTense="will not be",i.Infinitive+=" not",i.PerfectTense="not "+i.PerfectTense,i.Pluperfect="not "+i.Pluperfect,i.Gerund="not "+i.Gerund),i};var rn=function(t){let e=t.verb.text();return{PastTense:e+" have",PresentTense:e,FutureTense:e,Infinitive:e}};var nn=function(t,e){let r=t.verb;if(r.has("#Copula")||"be"===r.out("normal")&&t.auxiliary.has("will"))return en(t);if(t.auxiliary.has("are")&&r.has("#Gerund")){let r=t.original.clone(),n=r.clone().replace("are","were"),i=r.clone().replace("are","will be"),s=Jr(t,e);return{PastTense:n.text(),PresentTense:r.text(),FutureTense:i.text(),Infinitive:s}}if(r.has("#Modal"))return rn(t);let n=t.verb.termList(0).hasHyphen(),i=Jr(t,e);if(!i)return{};let s=e.transforms.conjugate(i,e);if(s.Infinitive=i,t.particle.found){let e=t.particle.text(),r=!0===n?"-":" ";Object.keys(s).forEach(t=>s[t]+=r+e)}const o=t.negative.found;return o&&(s.PastTense="did not "+s.Infinitive,s.PresentTense="does not "+s.Infinitive,s.Gerund="not "+s.Gerund),s.FutureTense||(s.FutureTense=o?"will not "+s.Infinitive:"will "+s.Infinitive),o&&(s.Infinitive="not "+s.Infinitive),s};var sn={useParticiple:function(t){return!!t.auxiliary.has("(could|should|would|may|can|must)")||(!!t.auxiliary.has("am .+? being")||!!t.auxiliary.has("had .+? been"))},toParticiple:function(t,e){if(t.auxiliary.has("(have|had)")&&t.verb.has("#Participle"))return;let r=nn(t,e),n=r.Participle||r.PastTense;n&&t.verb.replaceWith(n,!1),t.auxiliary.has("am .+? being")&&(t.auxiliary.remove("am"),t.auxiliary.replace("being","have been")),t.auxiliary.has("have")||t.auxiliary.append("have"),t.verb.tag("Participle","toParticiple"),t.auxiliary.replace("can","could"),t.auxiliary.replace("be have","have been"),t.auxiliary.replace("not have","have not"),t.auxiliary.tag("Auxiliary")}};const{toParticiple:on,useParticiple:an}=sn,ln=function(t){return t.auxiliary.remove("(will|are|am|being)"),t.auxiliary.remove("(did|does)"),t.auxiliary.remove("(had|has|have)"),t.particle.remove(),t.negative.remove(),t};var un={json:function(t){let e=null;"number"==typeof t&&(e=t,t=null),t=t||{text:!0,normal:!0,trim:!0,terms:!0};let r=[];return this.forEach(e=>{let n=e.json(t)[0],i=tn(e);n.parts={},Object.keys(i).forEach(t=>{i[t]&&"Doc"===i[t].isA?n.parts[t]=i[t].text("normal"):n.parts[t]=i[t]}),n.isNegative=e.has("#Negative"),n.conjugations=nn(i,this.world),r.push(n)}),null!==e?r[e]:r},adverbs:function(){let t=[];this.forEach(e=>{let r=tn(e).adverb;r.found&&(t=t.concat(r.list))});let e=this.lookBehind("#Adverb+$");return e.found&&(t=e.list.concat(t)),e=this.lookAhead("^#Adverb+"),e.found&&(t=t.concat(e.list)),this.buildFrom(t)},isPlural:function(){let t=[];return this.forEach(e=>{let r=tn(e);!0===Yr(r,this.world)&&t.push(e.list[0])}),this.buildFrom(t)},isSingular:function(){let t=[];return this.forEach(e=>{let r=tn(e);!1===Yr(r,this.world)&&t.push(e.list[0])}),this.buildFrom(t)},conjugate:function(){let t=[];return this.forEach(e=>{let r=tn(e),n=nn(r,this.world);t.push(n)}),t},toPastTense:function(){return this.forEach(t=>{let e=tn(t);if(an(e))return void on(e,this.world);if(t.has("#Imperative"))return;if(t.has("be")&&t.lookBehind("to$").found)return;if(e.verb.has("#Gerund")&&e.auxiliary.has("(is|will|was)"))return void t.replace("is","was");let r=nn(e,this.world).PastTense;r&&(e=ln(e),e.verb.replaceWith(r,!1))}),this},toPresentTense:function(){return this.forEach(t=>{let e=tn(t),r=nn(e,this.world),n=r.PresentTense;if(t.lookBehind("(i|we) (#Adverb|#Verb)?$").found&&(n=r.Infinitive),n){if(e.auxiliary.has("(have|had) been"))return e.auxiliary.replace("(have|had) been","am being"),void(r.Particle&&(n=r.Particle||r.PastTense));e.verb.replaceWith(n,!1),e.verb.tag("PresentTense"),e=ln(e),e.auxiliary.remove("#Modal")}}),this},toFutureTense:function(){return this.forEach(t=>{let e=tn(t);if(an(e))return;let r=nn(e,this.world).FutureTense;r&&(e=ln(e),e.auxiliary.remove("#Modal"),e.verb.replaceWith(r,!1),e.verb.tag("FutureTense"))}),this},toInfinitive:function(){return this.forEach(t=>{let e=tn(t),r=nn(e,this.world).Infinitive;r&&(t.replaceWith(r,!1),t.tag("Infinitive"))}),this},toGerund:function(){return this.forEach(t=>{let e=tn(t),r=nn(e,this.world).Gerund;r&&(t.replaceWith(r,!1),t.tag("Gerund"))}),this},toParticiple:function(){return this.forEach(t=>{let e=tn(t),r=!e.auxiliary.found;on(e,this.world),r&&(e.verb.prepend(e.auxiliary.text()),e.auxiliary.remove())}),this},isNegative:function(){return this.if("#Negative")},isPositive:function(){return this.ifNo("#Negative")},isImperative:function(){return this.if("#Imperative")},toNegative:function(){return this.list.forEach(t=>{let e=this.buildFrom([t]),r=tn(e);Kr(r,e.world)}),this},toPositive:function(){let t=this.match("do not #Verb");return t.found&&t.remove("do not"),this.remove("#Negative")},subject:function(){let t=[];return this.forEach(e=>{let r=Xr(e);r.list[0]&&t.push(r.list[0])}),this.buildFrom(t)}};const hn=[jr,Or,Cr,Fr,Tr,qr,Ur,Hr,Zr,function(t){class e extends t{}return Object.assign(e.prototype,un),e.prototype.negate=e.prototype.toNegative,t.prototype.verbs=function(t){let r=this.match("(#Adverb|#Auxiliary|#Verb|#Negative|#Particle)+");r=r.not("^#Adverb+"),r=r.not("#Adverb+$");let n=r.match("(#Adverb && @hasComma) #Adverb"),i=r.not(n).splitAfter("@hasComma"),s=i.match("#PastTense #Gerund");return s.has("(been|am|#Auxiliary) #Gerund")||(i=i.splitBefore(s.match("#Gerund"))),i=i.concat(n),i.sort("index"),i=i.if("#Verb"),i.has("(is|was)$")&&(i=i.splitBefore("(is|was)$")),i.has("#PresentTense #Adverb #PresentTense")&&(i=i.splitBefore("#Adverb #PresentTense")),"number"==typeof t&&(i=i.get(t)),new e(i.list,this,this.world)},t},function(t){class e extends t{}return t.prototype.people=function(t){let r=this.splitAfter("@hasComma");return r=r.match("#Person+"),"number"==typeof t&&(r=r.get(t)),new e(r.list,this,this.world)},t}];var cn=function(t){return Object.keys(yr).forEach(e=>t.prototype[e]=yr[e]),hn.forEach(e=>e(t)),t};const fn={misc:vr,selections:yr};class pn{constructor(t,e,r){this.list=t,Object.defineProperty(this,"from",{enumerable:!1,value:e,writable:!0}),void 0===r&&void 0!==e&&(r=e.world),Object.defineProperty(this,"world",{enumerable:!1,value:r,writable:!0}),Object.defineProperty(this,"_cache",{enumerable:!1,writable:!0,value:{}}),Object.defineProperty(this,"found",{get:()=>this.list.length>0}),Object.defineProperty(this,"length",{get:()=>this.list.length}),Object.defineProperty(this,"isA",{get:()=>"Doc"})}tagger(){return Pr(this)}pool(){return this.list.length>0?this.list[0].pool:this.all().list[0].pool}}pn.prototype.buildFrom=function(t){return t=t.map(t=>t.clone(!0)),new pn(t,this,this.world)},pn.prototype.fromText=function(t){let e=oe(t,this.world,this.pool());return this.buildFrom(e)},Object.assign(pn.prototype,fn.misc),Object.assign(pn.prototype,fn.selections),cn(pn);const dn={untag:"unTag",and:"match",notIf:"ifNo",only:"if",onlyIf:"if"};Object.keys(dn).forEach(t=>pn.prototype[t]=pn.prototype[dn[t]]);var mn=pn;return function t(e){let r=e;const n=function(t="",e){e&&r.addWords(e);let n=oe(t,r),i=new mn(n,null,r);return i.tagger(),i};return n.tokenize=function(t="",e){let n=r;e&&(n=n.clone(),n.words={},n.addWords(e));let i=oe(t,n),s=new mn(i,null,n);return(e||s.world.taggers.length>0)&&Pr(s),s},n.extend=function(t){return t(mn,r,this,Mt,Y,_t),this},n.fromJSON=function(t){let e=ae(t,r);return new mn(e,null,r)},n.clone=function(){return t(r.clone())},n.verbose=function(t=!0){return r.verbose(t),this},n.world=function(){return r},n.parseMatch=function(t,e){return $t(t,e)},n.version="13.11.1",n.import=n.load,n.plugin=n.extend,n}(new Ie)}));
